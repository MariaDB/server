CREATE TABLE t1(
vb VARBINARY(64) primary key
) ENGINE=rocksdb;
INSERT INTO t1 values(0x00);
INSERT INTO t1 values(0x0000);
INSERT INTO t1 values(0x0000000000000000);
INSERT INTO t1 values(0x000000);
INSERT INTO t1 values(0x000000000000000000000000000000000000000000000000000000000000000000);
INSERT INTO t1 values(0x00000000000000000000000000000000000000000000000000000000000000);
INSERT INTO t1 values(0x0000000000000000000000000000000000000000000000000000000000000000);
INSERT INTO t1 values(0x00000000);
INSERT INTO t1 values(0x0000000000);
INSERT INTO t1 values(0x00000000000000000000);
INSERT INTO t1 values(0x000000000000);
INSERT INTO t1 values(0x00000000000000);
INSERT INTO t1 values(0x000000000000000000);
SELECT hex(vb) FROM t1;
hex(vb)
00
0000
000000
00000000
0000000000
000000000000
00000000000000
0000000000000000
000000000000000000
00000000000000000000
00000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000
BEGIN;
SELECT hex(vb) FROM t1 FOR UPDATE;
hex(vb)
00
0000
000000
00000000
0000000000
000000000000
00000000000000
0000000000000000
000000000000000000
00000000000000000000
00000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000
SELECT SUBSTRING(a.key,9) FROM information_schema.rocksdb_locks AS a ORDER BY a.key;
SUBSTRING(a.key,9)
000000000000000001
000000000000000002
000000000000000003
000000000000000004
000000000000000005
000000000000000006
000000000000000007
000000000000000008
000000000000000009000000000000000001
000000000000000009000000000000000002
000000000000000009000000000000000009000000000000000009000000000000000007
000000000000000009000000000000000009000000000000000009000000000000000008
000000000000000009000000000000000009000000000000000009000000000000000009000000000000000001
ROLLBACK;
DROP TABLE t1;
set session debug_dbug= '+d,MYROCKS_LEGACY_VARBINARY_FORMAT';
CREATE TABLE t1(
vb VARBINARY(64) primary key
) ENGINE=rocksdb;
set session debug_dbug= '-d,MYROCKS_LEGACY_VARBINARY_FORMAT';
INSERT INTO t1 values(0x00);
INSERT INTO t1 values(0x0000);
INSERT INTO t1 values(0x0000000000000000);
INSERT INTO t1 values(0x000000);
INSERT INTO t1 values(0x000000000000000000000000000000000000000000000000000000000000000000);
INSERT INTO t1 values(0x00000000000000000000000000000000000000000000000000000000000000);
INSERT INTO t1 values(0x0000000000000000000000000000000000000000000000000000000000000000);
INSERT INTO t1 values(0x00000000);
INSERT INTO t1 values(0x0000000000);
INSERT INTO t1 values(0x00000000000000000000);
INSERT INTO t1 values(0x000000000000);
INSERT INTO t1 values(0x00000000000000);
INSERT INTO t1 values(0x000000000000000000);
SELECT hex(vb) FROM t1;
hex(vb)
00
0000
000000
00000000
0000000000
000000000000
00000000000000
0000000000000000
000000000000000000
00000000000000000000
00000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000
BEGIN;
SELECT hex(vb) FROM t1 FOR UPDATE;
hex(vb)
00
0000
000000
00000000
0000000000
000000000000
00000000000000
0000000000000000
000000000000000000
00000000000000000000
00000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000
SELECT SUBSTRING(a.key,9) FROM information_schema.rocksdb_locks AS a ORDER BY a.key;
SUBSTRING(a.key,9)
0000000000000000f8
0000000000000000f9
0000000000000000fa
0000000000000000fb
0000000000000000fc
0000000000000000fd
0000000000000000fe
0000000000000000ff0000000000000000f7
0000000000000000ff0000000000000000f8
0000000000000000ff0000000000000000f9
0000000000000000ff0000000000000000ff0000000000000000ff0000000000000000fe
0000000000000000ff0000000000000000ff0000000000000000ff0000000000000000ff0000000000000000f7
0000000000000000ff0000000000000000ff0000000000000000ff0000000000000000ff0000000000000000f8
ROLLBACK;
DROP TABLE t1;
CREATE TABLE t1(
vc VARCHAR(64) collate 'binary' primary key
) ENGINE=rocksdb;
INSERT INTO t1 values('a');
INSERT INTO t1 values('aa');
INSERT INTO t1 values('aaaaaaaa');
INSERT INTO t1 values('aaa');
INSERT INTO t1 values('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
INSERT INTO t1 values('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
INSERT INTO t1 values('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
INSERT INTO t1 values('aaaa');
INSERT INTO t1 values('aaaaa');
INSERT INTO t1 values('aaaaaaaaaa');
INSERT INTO t1 values('aaaaaa');
INSERT INTO t1 values('aaaaaaa');
INSERT INTO t1 values('aaaaaaaaa');
SELECT * FROM t1;
vc
a
aa
aaa
aaaa
aaaaa
aaaaaa
aaaaaaa
aaaaaaaa
aaaaaaaaa
aaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
BEGIN;
SELECT * FROM t1 FOR UPDATE;
vc
a
aa
aaa
aaaa
aaaaa
aaaaaa
aaaaaaa
aaaaaaaa
aaaaaaaaa
aaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
SELECT SUBSTRING(a.key,9) FROM information_schema.rocksdb_locks AS a ORDER BY a.key;
SUBSTRING(a.key,9)
610000000000000001
616100000000000002
616161000000000003
616161610000000004
616161616100000005
616161616161000006
616161616161610007
616161616161616108
616161616161616109610000000000000001
616161616161616109616100000000000002
616161616161616109616161616161616109616161616161616109616161616161610007
616161616161616109616161616161616109616161616161616109616161616161616108
616161616161616109616161616161616109616161616161616109616161616161616109610000000000000001
ROLLBACK;
DROP TABLE t1;
set session debug_dbug= '+d,MYROCKS_LEGACY_VARBINARY_FORMAT';
CREATE TABLE t1(
vc VARCHAR(64) collate 'binary' primary key
) ENGINE=rocksdb;
set session debug_dbug= '-d,MYROCKS_LEGACY_VARBINARY_FORMAT';
INSERT INTO t1 values('a');
INSERT INTO t1 values('aa');
INSERT INTO t1 values('aaaaaaaa');
INSERT INTO t1 values('aaa');
INSERT INTO t1 values('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
INSERT INTO t1 values('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
INSERT INTO t1 values('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
INSERT INTO t1 values('aaaa');
INSERT INTO t1 values('aaaaa');
INSERT INTO t1 values('aaaaaaaaaa');
INSERT INTO t1 values('aaaaaa');
INSERT INTO t1 values('aaaaaaa');
INSERT INTO t1 values('aaaaaaaaa');
SELECT * FROM t1;
vc
a
aa
aaa
aaaa
aaaaa
aaaaaa
aaaaaaa
aaaaaaaa
aaaaaaaaa
aaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
BEGIN;
SELECT * FROM t1 FOR UPDATE;
vc
a
aa
aaa
aaaa
aaaaa
aaaaaa
aaaaaaa
aaaaaaaa
aaaaaaaaa
aaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
SELECT SUBSTRING(a.key,9) FROM information_schema.rocksdb_locks AS a ORDER BY a.key;
SUBSTRING(a.key,9)
6100000000000000f8
6161000000000000f9
6161610000000000fa
6161616100000000fb
6161616161000000fc
6161616161610000fd
6161616161616100fe
6161616161616161ff0000000000000000f7
6161616161616161ff6100000000000000f8
6161616161616161ff6161000000000000f9
6161616161616161ff6161616161616161ff6161616161616161ff6161616161616100fe
6161616161616161ff6161616161616161ff6161616161616161ff6161616161616161ff0000000000000000f7
6161616161616161ff6161616161616161ff6161616161616161ff6161616161616161ff6100000000000000f8
ROLLBACK;
DROP TABLE t1;

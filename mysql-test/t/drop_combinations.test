#
# Test different combinations of doing DROP TABLE/VIEW
#

SET @save_default_engine= @@DEFAULT_STORAGE_ENGINE;
SET default_storage_engine=myisam;
let $DATADIR= `select @@datadir`;

# Create tables t1,t2 and views v1,v2
let $create_option=;
--source drop_combinations.inc

--echo #
--echo # DROP TABLE
--echo #

--error ER_BAD_TABLE_ERROR
drop table t1,t2,t3;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop table t1,t3,t2;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop table t1,t4,t2,t3;
show warnings;
--source drop_combinations.inc
drop table t1,t2;
--source drop_combinations.inc
--error ER_IT_IS_A_VIEW
drop table t1,v1,v2,t2;
show warnings;
--source drop_combinations.inc
--error ER_IT_IS_A_VIEW
drop table v1,v2,t2;
show warnings;
--source drop_combinations.inc
--remove_file $DATADIR/test/t1.MYD
--error ER_IT_IS_A_VIEW
drop table t1,v1,t3,t4;
show warnings;
--error ER_IT_IS_A_VIEW
drop table v2,t2,t1;
show warnings;
--source drop_combinations.inc
--error ER_IT_IS_A_VIEW
drop table v1,v2;
show warnings;
--source drop_combinations.inc

--echo #
--echo # DROP TABLE with if exists
--echo #

drop table if exists t1,t2,t3;
--source drop_combinations.inc
drop table if exists t1,t3,t2;
--source drop_combinations.inc
drop table if exists t1,t4,t2,t3;
--source drop_combinations.inc
drop table if exists t1,t2;
--source drop_combinations.inc
drop table if exists t1,v1,v2,t2;
--source drop_combinations.inc
drop table if exists v1,v2,t2;
--source drop_combinations.inc
--remove_file $DATADIR/test/t1.MYD
--replace_result \\ /
drop table if exists t1,v1,t3,t4;
drop table if exists v2,t2,t1;
--source drop_combinations.inc
drop table if exists v1,v2;
--source drop_combinations.inc

--echo #
--echo # DROP TEMPORARY TABLE
--echo #

--disable_warnings
drop table if exists t1,t2;
drop temporary table if exists tt1,tt2;
drop view if exists v1,v2;
--enable_warnings
let $create_option=temporary;

--error ER_BAD_TABLE_ERROR
drop temporary table t1,t2,t3;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop temporary table t1,t3,t2;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop temporary table t1,t4,t2,t3;
show warnings;
--source drop_combinations.inc
drop temporary table t1,t2;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop temporary table t1,v1,v2,t2;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop temporary table v1,v2,t2;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop temporary table t1,v1,t3,t4;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop temporary table v2,t2,t1;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop temporary table v1,v2;
show warnings;
--source drop_combinations.inc

--echo #
--echo # DROP TEMPORARY TABLE with if exists
--echo #

drop temporary table if exists t1,t2,t3;
--source drop_combinations.inc
drop temporary table if exists t1,t3,t2;
--source drop_combinations.inc
drop temporary table if exists t1,t4,t2,t3;
--source drop_combinations.inc
drop temporary table if exists t1,t2;
--source drop_combinations.inc
drop temporary table if exists t1,v1,v2,t2;
--source drop_combinations.inc
drop temporary table if exists v1,v2,t2;
--source drop_combinations.inc
drop temporary table if exists t1,v1,t3,t4;
drop temporary table if exists v2,t2,t1;
--source drop_combinations.inc
drop temporary table if exists v1,v2;
--source drop_combinations.inc

let $create_option=;
drop temporary table t1,t2;
--source drop_combinations.inc

--echo #
--echo # DROP VIEW
--echo #

--error ER_BAD_TABLE_ERROR
drop view v1,v2,v3;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop view v1,v3,v2;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop view v1,v4,v2,v3;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop view v1,t1,t2,v2;
show warnings;
--source drop_combinations.inc
drop view v1,v2;
show warnings;
--source drop_combinations.inc
--remove_file $DATADIR/test/t1.MYD
--replace_result \\ /
--error ER_BAD_TABLE_ERROR
drop view t1,t2,v2;
show warnings;
drop table t1;
show warnings;
--error ER_BAD_TABLE_ERROR
drop view v1,t1;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop view v1,t1,t3,v4;
show warnings;
--error ER_BAD_TABLE_ERROR
drop view t2,v2,v1;
show warnings;
--source drop_combinations.inc
--error ER_BAD_TABLE_ERROR
drop view t1,t2;
show warnings;
--source drop_combinations.inc

--echo #
--echo # DROP VIEW with if exists
--echo #

drop view if exists v1,v2,v3;
--source drop_combinations.inc
drop view if exists v1,v3,v2;
--source drop_combinations.inc
drop view if exists v1,v4,v2,v3;
--source drop_combinations.inc
drop view if exists v1,t1,t2,v2;
--source drop_combinations.inc
drop view if exists v1,v2;
--source drop_combinations.inc
drop view if exists t1,t2,v2;
drop table t1;
drop view if exists v1,t1;
--source drop_combinations.inc
drop view if exists v1,t1,t3,v4;
drop view if exists t2,v2,v1;
--source drop_combinations.inc
drop view if exists t1,t2;
--source drop_combinations.inc

--echo # cleanup
drop table if exists t1,t2;
drop view if exists v1,v2;

SET default_storage_engine=@save_default_engine;

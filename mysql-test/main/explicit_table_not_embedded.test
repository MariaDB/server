--echo #
--echo #privileges
--echo #
--source include/not_embedded.inc

connect (master,localhost,root,,);
connection master;

create database explicit_test;
use explicit_test;
create table master (selc int, upc int, insc int, delc int);
create view public as table master;
alter table master add column privc int;
create user user_explicit_test@localhost;

grant select(selc) on explicit_test.public to user_explicit_test@localhost;
grant update(upc) on explicit_test.public to user_explicit_test@localhost;
grant insert on explicit_test.public to user_explicit_test@localhost;
#grant insert, create on explicit_test.t2 to user_explicit_test@localhost;

connect (connect_explicit_test, localhost, user_explicit_test,,explicit_test);
connection connect_explicit_test;
--error ER_TABLEACCESS_DENIED_ERROR
table public;
--echo # OK
select selc from public;
--error ER_BAD_FIELD_ERROR
select privc from public;
--echo # OK
insert into public (selc) values (1);
--error ER_COLUMNACCESS_DENIED_ERROR
update public set selc = 2 where selc = 1;
update public set upc = 2;

connection master;
revoke all privileges, grant option from user_explicit_test@localhost;
drop user user_explicit_test@localhost;
drop database explicit_test;

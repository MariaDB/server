
# Copyright (c) 2014, Oracle and/or its affiliates
# Copyright (c) 2024, MariaDB Corporation.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1335  USA

-- disable_warnings

# Table with different extreme values
CREATE TABLE geohashes  (gid INT NOT NULL PRIMARY KEY, hash_value VARCHAR(255));
INSERT INTO geohashes VALUES
  (1, "000000000000000000000"),
  (2, "zzzzzzzzzzzzzzzzzzzzz"),
  (3, NULL),
  (4, "s00t"),
  (5, "7zzzm"),
  (6, "s00d"),
  (7, "0"),
  (8, "z"),
  (9, "3ejh6z75ddt2d839zh2u"),
  (10, "twtsuqg3q7vh3nrbt0nn"),
  (11, "yw8s10dxddhe4s06nsph"),
  (12, "h4g4h9yrjtgzvewxm0ru"),
  (13, "9kqbredcnhq1b44ue48s"),
  (14, "1pckwjkqw3km0v6ye5d2"),
  (15, "wm313fnr92ggsysm64e6"),
  (16, "vqghx20fx6d8r5vfkbgf"),
  (17, "wvetm3u23kr9r6663k31"),
  (18, "e5t2p7sk291vpyb08pwu");

#####################################################################
# ST_LATFROMGEOHASH()
#####################################################################

# Check for all valid characters and inputs
--echo # valid characters
SELECT ST_LATFROMGEOHASH("0");

SELECT ST_LATFROMGEOHASH("z");

SELECT ST_LATFROMGEOHASH("0z");

SELECT ST_LATFROMGEOHASH("xbpb");

SELECT ST_LATFROMGEOHASH("8000");

SELECT ST_LATFROMGEOHASH("s000");

SELECT ST_LATFROMGEOHASH("0123456789");

SELECT ST_LATFROMGEOHASH("9876543210");

SELECT ST_LATFROMGEOHASH("bcdefghjkmnpqrstuvwxyz");

SELECT ST_LATFROMGEOHASH("zyxwvutsrqpnmkjhgfedcb");

SELECT ST_LATFROMGEOHASH("zzzzzzzzzzzzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("bpbpbpbpbpbpbpbpbpbp");

SELECT ST_LATFROMGEOHASH("pbpbpbpbpbpbpbpbpbpb");

SELECT ST_LATFROMGEOHASH("00000000000000000000");

SELECT ST_LATFROMGEOHASH("gzzzzzzzzzzzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("5bpbpbpbpbpbpbpbpbpb");

SELECT ST_LATFROMGEOHASH("7zzzzzzzzzzzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("rzzzzzzzzzzzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("2pbpbpbpbpbpbpbpbpbp");

SELECT ST_LATFROMGEOHASH("0000000000zzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("zzzzzzzzzz0000000000");

SELECT ST_LATFROMGEOHASH("s000000001z7wsg7zzm6");

SELECT ST_LATFROMGEOHASH("ebpbpbpbpcbe9kuebp6d");

SELECT ST_LATFROMGEOHASH("kpbpbpbpbnpkqe5kpbtm");

SELECT ST_LATFROMGEOHASH("7zzzzzzzzy0s37hs00dt");

SELECT ST_LATFROMGEOHASH("tzzzzzzzzzzzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("9zzzzzzzzzzzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("jzzzzzzzzzzzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("1zzzzzzzzzzzzzzzzzzz");

SELECT ST_LATFROMGEOHASH("zbzurypzpgxczbzurypz");

SELECT ST_LATFROMGEOHASH("5zpgxczbzurypzpgxczb");

SELECT ST_LATFROMGEOHASH("0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z");

SELECT ST_LATFROMGEOHASH("0123456789bcdefghjkmnpqrstuvwxyz");

SELECT ST_LATFROMGEOHASH("0123456789BCDEFGHJKMNPQRSTUVWXYZ");

SELECT ST_LATFROMGEOHASH("zyxwvutsrqpnmkjhgfedcb9876543210");

SELECT ST_LATFROMGEOHASH("ZYXWVUTSRQPNMKJHGFEDCB9876543210");

SELECT ST_LATFROMGEOHASH("1e1");

SELECT ST_LATFROMGEOHASH("100");

SELECT ST_LATFROMGEOHASH(CAST(100 AS CHAR));

SELECT ST_LATFROMGEOHASH("10111000110001111001");

SELECT ST_LATFROMGEOHASH("11111111111111111111");

SELECT ST_LATFROMGEOHASH("99999999999999999999");

SELECT ST_LATFROMGEOHASH(NULL);

SELECT ST_LATFROMGEOHASH(null);

SELECT ST_LATFROMGEOHASH(CAST("012" AS BINARY));

# Invalid characters and inputs
--echo # invalid characters and inputs
--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("0123a45");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("xyzi");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("zyxLwv");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("bcdjo");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("zyx**wv");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("1 2 3 4");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("1''2345");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("12.345");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("   ");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("NULL");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("-100");

--error ER_WRONG_VALUE_FOR_TYPE
SELECT ST_LATFROMGEOHASH("");

--error ER_GIS_INVALID_DATA
SELECT ST_LATFROMGEOHASH(9876543210);

--error ER_GIS_INVALID_DATA
SELECT ST_LATFROMGEOHASH(0123456789);

--error ER_GIS_INVALID_DATA
SELECT ST_LATFROMGEOHASH(1e1);

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_LATFROMGEOHASH();

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_LATFROMGEOHASH("123","456");

--error ER_PARSE_ERROR
SELECT ST_LATFROMGEOHASH("123",);

--error ER_PARSE_ERROR
SELECT ST_LATFROMGEOHASH(,"456");

--error ER_PARSE_ERROR
SELECT ST_LATFROMGEOHASH(,);

--error ER_PARSE_ERROR
SELECT ST_LATFROMGEOHASH("0123456"789);

--error ER_BAD_FIELD_ERROR
SELECT ST_LATFROMGEOHASH(abcdef);

# Test geohashes that are long
--echo # very long geohash
SELECT ST_LATFROMGEOHASH("0123456789bcdefghjkmnpqrstuvwxyz0123456789bcdefghjkmn"
                         "pqrstuvwxyz0123456789bcdefghjkmnpqrstuvwxyz0123456789"
                         "bcdefghjkmnpqrstuvwxyz");

SELECT ST_LATFROMGEOHASH("0123456789BCDEFGHJKMNPQRSTUVWXYZ0123456789BCDEFGHJKMN"
                         "PQRSTUVWXYZ0123456789BCDEFGHJKMNPQRSTUVWXYZ0123456789"
                         "BCDEFGHJKMNPQRSTUVWXYZ");

SELECT ST_LATFROMGEOHASH("zyxwvutsrqpnmkjhgfedcb9876543210zyxwvutsrqpnmkjhgfedc"
                         "b9876543210zyxwvutsrqpnmkjhgfedcb9876543210zyxwvutsrq"
                         "pnmkjhgfedcb9876543210");

SELECT ST_LATFROMGEOHASH("ZYXWVUTSRQPNMKJHGFEDCB9876543210ZYXWVUTSRQPNMKJHGFEDC"
                         "B9876543210ZYXWVUTSRQPNMKJHGFEDCB9876543210ZYXWVUTSRQ"
                         "PNMKJHGFEDCB9876543210");

--echo # different random geohash values
SELECT ST_LATFROMGEOHASH(hash_value) FROM geohashes;

#####################################################################
# ST_GEOHASH()
#####################################################################

# Check for all valid inputs
--echo # valid inputs
SELECT ST_GEOHASH(0,0,1);

SELECT ST_GEOHASH(180,0,20);

SELECT ST_GEOHASH(-180,0,20);

SELECT ST_GEOHASH(0,90,20);

SELECT ST_GEOHASH(0,-90,20);

SELECT ST_GEOHASH(180,90,20);

SELECT ST_GEOHASH(180,-90,20);

SELECT ST_GEOHASH(-180,90,20);

SELECT ST_GEOHASH(-180,-90,20);

SELECT ST_GEOHASH(100,45,5);

SELECT ST_GEOHASH(100,-45,10);

SELECT ST_GEOHASH(-100,45,+50);

SELECT ST_GEOHASH(0.0001,0.0001,10);

SELECT ST_GEOHASH(0.0001,-0.0001,30);

SELECT ST_GEOHASH(-0.0001,0.0001,90);

SELECT ST_GEOHASH(-0.0001,-0.0001,100);

SELECT ST_GEOHASH("",90,10);

SELECT ST_GEOHASH(0,"90",10);

SELECT ST_GEOHASH("0","0",10);

SELECT ST_GEOHASH(180,90,"20");

SELECT ST_GEOHASH("180","90","20");

SELECT ST_GEOHASH("***",90,"20");

SELECT ST_GEOHASH(180,"***",20);

SELECT ST_GEOHASH("abcd",90,20);

SELECT ST_GEOHASH(180,"abcd",25-5);

SELECT ST_GEOHASH(NULL,90,10);

SELECT ST_GEOHASH(180,NULL,10);

SELECT ST_GEOHASH(180,90,NULL);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)'),10);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 0)'),20);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-180 0)'),25);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 90)'),30);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 -90)'),35);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 90)'),40);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 -90)'),45);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-180 90)'),50);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-180 -90)'),55);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(100 45)'),60);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(100 -45)'),65);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-100 45)'),70);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-100 -45)'),75);

SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(0.0001 0.0001)'))),80);

SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(0.0001 -0.0001)'))),85);

SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(-0.0001 0.0001)'))),90);

SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(-0.0001 -0.0001)'))),100);

SELECT ST_GEOHASH(ST_GEOMFROMWKB(0x010100000000000000008066400000000000805640),20);

SELECT ST_GEOHASH(ST_GEOMFROMWKB(0x010100000000000000008066C00000000000805640),20);

SELECT ST_GEOHASH(ST_GEOMFROMWKB(0x00000000014066800000000000C056800000000000),20);

SELECT ST_GEOHASH(ST_GEOMFROMWKB(0x0000000001C066800000000000C056800000000000),20);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)'),"1");

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)')," 10 ");

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)'),"+100");

SELECT ST_GEOHASH(NULL,100);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-0.0001 -0.0001)'),NULL);

SELECT ST_GEOHASH(ST_DIFFERENCE(ST_GEOMFROMTEXT('POINT(180 90)'),ST_GEOMFROMTEXT('POINT(0 0)')),20);

SELECT ST_GEOHASH(ST_DIFFERENCE(ST_GEOMFROMTEXT('POINT(-180 90)'),ST_GEOMFROMTEXT('MULTIPOINT(0 0,100 100)')),20);

SELECT ST_GEOHASH(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT(180 -90)'),ST_GEOMFROMTEXT('POINT(180 -90)')),20);

SELECT ST_GEOHASH(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT(-180 -90)'),ST_GEOMFROMTEXT('POINT(-180 -90)')),20);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 90)'),(CAST(10 AS BINARY)));

SELECT ST_GEOHASH((CAST(10 AS BINARY)),20,1);

SELECT ST_GEOHASH(10,(CAST(20 AS BINARY)),1);

SELECT ST_GEOHASH((CAST(10 AS BINARY)),(CAST(20 AS BINARY)),1);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT()'),20);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(1)'),20);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(1 a)'),20);

SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180,90)'),20);

# Invalid inputs
--echo # invalid inputs
--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(181,0,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(1000,90,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180.0000000000001,-90,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(-181,0,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(-1000,90,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(-180.0000000000001,-90,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(0,91,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,500,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(-180,90.0000000000001,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(0,-91,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,-500,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(-180,-90.0000000000001,10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,90,0);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(-180,90,-1);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,-90,-100);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(-180,-90,101);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(0,90,1000);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH("181",90,20);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH("-181",90,20);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,"91",20);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,"-91",20);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,90,"0");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,90,"-1");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,90,"-100");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,90,"101");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,90,"1000");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,90,"");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(180,90,"****");

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_GEOHASH();

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_GEOHASH(1);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(1,2);

# --error ER_GIS_INVALID_DATA
# SELECT ST_GEOHASH(-100,-45,100.1);

--error ER_PARSE_ERROR
SELECT ST_GEOHASH(, ,);

--error ER_PARSE_ERROR
SELECT ST_GEOHASH(1,2,);

--error ER_PARSE_ERROR
SELECT ST_GEOHASH(*,0,10);

--error ER_PARSE_ERROR
SELECT ST_GEOHASH(0,*,10);

--error ER_PARSE_ERROR
SELECT ST_GEOHASH(0,0,*);

--error ER_BAD_FIELD_ERROR
SELECT ST_GEOHASH(a,90,10);

--error ER_BAD_FIELD_ERROR
SELECT ST_GEOHASH(180,p,10);

--error ER_BAD_FIELD_ERROR
SELECT ST_GEOHASH(180,90,z);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH((CAST(180 AS DATE)),90,10);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(180,(CAST(90 AS DATE)),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(181 0)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(1000 90)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180.0000000000001 -90)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-181 0)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-1000 90)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-180.0000000000001 -90)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 91)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 500)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-180 90.0000000000001)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 -91)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 -500)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-180 -90.0000000000001)'),10);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 90)'),0);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 -90)'),-1);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-180 90)'),-100);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(-180 -90)'),101);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)'),10000);

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(180 90)'))),"0");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(180 -90)'))),"-1");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(-180 90)'))),"-100");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(-180 -90)'))),"101");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMWKB(ST_ASWKB(ST_GEOMFROMTEXT('POINT(0 0)'))),"10000");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)')," ");

--error ER_STD_OUT_OF_RANGE_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)'),"***");

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)'));

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_GEOHASH(ST_GEOMFROMTEXT(),20);

--error ER_PARSE_ERROR
SELECT ST_GEOHASH((ST_GEOMFROMTEXT('POINT(0 0)'),);

--error ER_PARSE_ERROR
SELECT ST_GEOHASH(,10);

--error ER_BAD_FIELD_ERROR
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(0 0)'),a);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'),10);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POLYGON((0 0,10 0,10 10,0 10,0 0))'),10);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('MULTIPOINT(0 0,10 10)'),10);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('MULTILINESTRING((0 0,10 10),(20 20,30 30))'),10);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),10);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'),10);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 90)'),20.0001);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_GEOMFROMTEXT('POINT(180 90)'),(CAST(10 AS DATE)));

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_INTERSECTION(ST_GEOMFROMTEXT('POINT(180 90)'),ST_GEOMFROMTEXT('POINT(1 1)')),20);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_UNION(ST_GEOMFROMTEXT('POINT(180 90)'),ST_GEOMFROMTEXT('POINT(-180 -90)')),20);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_DIFFERENCE(ST_GEOMFROMTEXT('POINT(180 90)'),ST_GEOMFROMTEXT('MULTIPOINT(0 0,180 90)')),20);

--error ER_GIS_INVALID_DATA
SELECT ST_GEOHASH(ST_SYMDIFFERENCE(ST_GEOMFROMTEXT('POINT(180 90)'),ST_GEOMFROMTEXT('POINT(0 0)')),20);

--echo # Clean up
DROP TABLE geohashes;

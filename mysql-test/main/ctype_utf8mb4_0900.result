DROP TABLE IF EXISTS t1;
select * from information_schema.COLLATION_CHARACTER_SET_APPLICABILITY
where collation_name like "%0900%" order by collation_name;
COLLATION_NAME	CHARACTER_SET_NAME	FULL_COLLATION_NAME	ID	IS_DEFAULT
utf8mb4_0900_ai_ci	utf8mb4	utf8mb4_0900_ai_ci	255	
utf8mb4_0900_as_ci	utf8mb4	utf8mb4_0900_as_ci	305	
utf8mb4_0900_as_cs	utf8mb4	utf8mb4_0900_as_cs	278	
utf8mb4_0900_bin	utf8mb4	utf8mb4_0900_bin	309	
utf8mb4_cs_0900_ai_ci	utf8mb4	utf8mb4_cs_0900_ai_ci	266	
utf8mb4_cs_0900_as_cs	utf8mb4	utf8mb4_cs_0900_as_cs	289	
utf8mb4_da_0900_ai_ci	utf8mb4	utf8mb4_da_0900_ai_ci	267	
utf8mb4_da_0900_as_cs	utf8mb4	utf8mb4_da_0900_as_cs	290	
utf8mb4_de_pb_0900_ai_ci	utf8mb4	utf8mb4_de_pb_0900_ai_ci	256	
utf8mb4_de_pb_0900_as_cs	utf8mb4	utf8mb4_de_pb_0900_as_cs	279	
utf8mb4_eo_0900_ai_ci	utf8mb4	utf8mb4_eo_0900_ai_ci	273	
utf8mb4_eo_0900_as_cs	utf8mb4	utf8mb4_eo_0900_as_cs	296	
utf8mb4_es_0900_ai_ci	utf8mb4	utf8mb4_es_0900_ai_ci	263	
utf8mb4_es_0900_as_cs	utf8mb4	utf8mb4_es_0900_as_cs	286	
utf8mb4_es_trad_0900_ai_ci	utf8mb4	utf8mb4_es_trad_0900_ai_ci	270	
utf8mb4_es_trad_0900_as_cs	utf8mb4	utf8mb4_es_trad_0900_as_cs	293	
utf8mb4_et_0900_ai_ci	utf8mb4	utf8mb4_et_0900_ai_ci	262	
utf8mb4_et_0900_as_cs	utf8mb4	utf8mb4_et_0900_as_cs	285	
utf8mb4_hr_0900_ai_ci	utf8mb4	utf8mb4_hr_0900_ai_ci	275	
utf8mb4_hr_0900_as_cs	utf8mb4	utf8mb4_hr_0900_as_cs	298	
utf8mb4_hu_0900_ai_ci	utf8mb4	utf8mb4_hu_0900_ai_ci	274	
utf8mb4_hu_0900_as_cs	utf8mb4	utf8mb4_hu_0900_as_cs	297	
utf8mb4_is_0900_ai_ci	utf8mb4	utf8mb4_is_0900_ai_ci	257	
utf8mb4_is_0900_as_cs	utf8mb4	utf8mb4_is_0900_as_cs	280	
utf8mb4_la_0900_ai_ci	utf8mb4	utf8mb4_la_0900_ai_ci	271	
utf8mb4_la_0900_as_cs	utf8mb4	utf8mb4_la_0900_as_cs	294	
utf8mb4_lt_0900_ai_ci	utf8mb4	utf8mb4_lt_0900_ai_ci	268	
utf8mb4_lt_0900_as_cs	utf8mb4	utf8mb4_lt_0900_as_cs	291	
utf8mb4_lv_0900_ai_ci	utf8mb4	utf8mb4_lv_0900_ai_ci	258	
utf8mb4_lv_0900_as_cs	utf8mb4	utf8mb4_lv_0900_as_cs	281	
utf8mb4_pl_0900_ai_ci	utf8mb4	utf8mb4_pl_0900_ai_ci	261	
utf8mb4_pl_0900_as_cs	utf8mb4	utf8mb4_pl_0900_as_cs	284	
utf8mb4_ro_0900_ai_ci	utf8mb4	utf8mb4_ro_0900_ai_ci	259	
utf8mb4_ro_0900_as_cs	utf8mb4	utf8mb4_ro_0900_as_cs	282	
utf8mb4_sk_0900_ai_ci	utf8mb4	utf8mb4_sk_0900_ai_ci	269	
utf8mb4_sk_0900_as_cs	utf8mb4	utf8mb4_sk_0900_as_cs	292	
utf8mb4_sl_0900_ai_ci	utf8mb4	utf8mb4_sl_0900_ai_ci	260	
utf8mb4_sl_0900_as_cs	utf8mb4	utf8mb4_sl_0900_as_cs	283	
utf8mb4_sv_0900_ai_ci	utf8mb4	utf8mb4_sv_0900_ai_ci	264	
utf8mb4_sv_0900_as_cs	utf8mb4	utf8mb4_sv_0900_as_cs	287	
utf8mb4_tr_0900_ai_ci	utf8mb4	utf8mb4_tr_0900_ai_ci	265	
utf8mb4_tr_0900_as_cs	utf8mb4	utf8mb4_tr_0900_as_cs	288	
utf8mb4_vi_0900_ai_ci	utf8mb4	utf8mb4_vi_0900_ai_ci	277	
utf8mb4_vi_0900_as_cs	utf8mb4	utf8mb4_vi_0900_as_cs	300	
select * from information_schema.COLLATIONS where collation_name like "%0900%";
COLLATION_NAME	CHARACTER_SET_NAME	ID	IS_DEFAULT	IS_COMPILED	SORTLEN	COMMENT
utf8mb4_0900_ai_ci	utf8mb4	255		Yes	8	Alias for utf8mb4_uca1400_nopad_ai_ci
utf8mb4_de_pb_0900_ai_ci	utf8mb4	256		Yes	8	Alias for utf8mb4_uca1400_german2_nopad_ai_ci
utf8mb4_is_0900_ai_ci	utf8mb4	257		Yes	8	Alias for utf8mb4_uca1400_icelandic_nopad_ai_ci
utf8mb4_lv_0900_ai_ci	utf8mb4	258		Yes	8	Alias for utf8mb4_uca1400_latvian_nopad_ai_ci
utf8mb4_ro_0900_ai_ci	utf8mb4	259		Yes	8	Alias for utf8mb4_uca1400_romanian_nopad_ai_ci
utf8mb4_sl_0900_ai_ci	utf8mb4	260		Yes	8	Alias for utf8mb4_uca1400_slovenian_nopad_ai_ci
utf8mb4_pl_0900_ai_ci	utf8mb4	261		Yes	8	Alias for utf8mb4_uca1400_polish_nopad_ai_ci
utf8mb4_et_0900_ai_ci	utf8mb4	262		Yes	8	Alias for utf8mb4_uca1400_estonian_nopad_ai_ci
utf8mb4_es_0900_ai_ci	utf8mb4	263		Yes	8	Alias for utf8mb4_uca1400_spanish_nopad_ai_ci
utf8mb4_sv_0900_ai_ci	utf8mb4	264		Yes	8	Alias for utf8mb4_uca1400_swedish_nopad_ai_ci
utf8mb4_tr_0900_ai_ci	utf8mb4	265		Yes	8	Alias for utf8mb4_uca1400_turkish_nopad_ai_ci
utf8mb4_cs_0900_ai_ci	utf8mb4	266		Yes	8	Alias for utf8mb4_uca1400_czech_nopad_ai_ci
utf8mb4_da_0900_ai_ci	utf8mb4	267		Yes	8	Alias for utf8mb4_uca1400_danish_nopad_ai_ci
utf8mb4_lt_0900_ai_ci	utf8mb4	268		Yes	8	Alias for utf8mb4_uca1400_lithuanian_nopad_ai_ci
utf8mb4_sk_0900_ai_ci	utf8mb4	269		Yes	8	Alias for utf8mb4_uca1400_slovak_nopad_ai_ci
utf8mb4_es_trad_0900_ai_ci	utf8mb4	270		Yes	8	Alias for utf8mb4_uca1400_spanish2_nopad_ai_ci
utf8mb4_la_0900_ai_ci	utf8mb4	271		Yes	8	Alias for utf8mb4_uca1400_roman_nopad_ai_ci
utf8mb4_eo_0900_ai_ci	utf8mb4	273		Yes	8	Alias for utf8mb4_uca1400_esperanto_nopad_ai_ci
utf8mb4_hu_0900_ai_ci	utf8mb4	274		Yes	8	Alias for utf8mb4_uca1400_hungarian_nopad_ai_ci
utf8mb4_hr_0900_ai_ci	utf8mb4	275		Yes	8	Alias for utf8mb4_uca1400_croatian_nopad_ai_ci
utf8mb4_vi_0900_ai_ci	utf8mb4	277		Yes	8	Alias for utf8mb4_uca1400_vietnamese_nopad_ai_ci
utf8mb4_0900_as_cs	utf8mb4	278		Yes	8	Alias for utf8mb4_uca1400_nopad_as_cs
utf8mb4_de_pb_0900_as_cs	utf8mb4	279		Yes	8	Alias for utf8mb4_uca1400_german2_nopad_as_cs
utf8mb4_is_0900_as_cs	utf8mb4	280		Yes	8	Alias for utf8mb4_uca1400_icelandic_nopad_as_cs
utf8mb4_lv_0900_as_cs	utf8mb4	281		Yes	8	Alias for utf8mb4_uca1400_latvian_nopad_as_cs
utf8mb4_ro_0900_as_cs	utf8mb4	282		Yes	8	Alias for utf8mb4_uca1400_romanian_nopad_as_cs
utf8mb4_sl_0900_as_cs	utf8mb4	283		Yes	8	Alias for utf8mb4_uca1400_slovenian_nopad_as_cs
utf8mb4_pl_0900_as_cs	utf8mb4	284		Yes	8	Alias for utf8mb4_uca1400_polish_nopad_as_cs
utf8mb4_et_0900_as_cs	utf8mb4	285		Yes	8	Alias for utf8mb4_uca1400_estonian_nopad_as_cs
utf8mb4_es_0900_as_cs	utf8mb4	286		Yes	8	Alias for utf8mb4_uca1400_spanish_nopad_as_cs
utf8mb4_sv_0900_as_cs	utf8mb4	287		Yes	8	Alias for utf8mb4_uca1400_swedish_nopad_as_cs
utf8mb4_tr_0900_as_cs	utf8mb4	288		Yes	8	Alias for utf8mb4_uca1400_turkish_nopad_as_cs
utf8mb4_cs_0900_as_cs	utf8mb4	289		Yes	8	Alias for utf8mb4_uca1400_czech_nopad_as_cs
utf8mb4_da_0900_as_cs	utf8mb4	290		Yes	8	Alias for utf8mb4_uca1400_danish_nopad_as_cs
utf8mb4_lt_0900_as_cs	utf8mb4	291		Yes	8	Alias for utf8mb4_uca1400_lithuanian_nopad_as_cs
utf8mb4_sk_0900_as_cs	utf8mb4	292		Yes	8	Alias for utf8mb4_uca1400_slovak_nopad_as_cs
utf8mb4_es_trad_0900_as_cs	utf8mb4	293		Yes	8	Alias for utf8mb4_uca1400_spanish2_nopad_as_cs
utf8mb4_la_0900_as_cs	utf8mb4	294		Yes	8	Alias for utf8mb4_uca1400_roman_nopad_as_cs
utf8mb4_eo_0900_as_cs	utf8mb4	296		Yes	8	Alias for utf8mb4_uca1400_esperanto_nopad_as_cs
utf8mb4_hu_0900_as_cs	utf8mb4	297		Yes	8	Alias for utf8mb4_uca1400_hungarian_nopad_as_cs
utf8mb4_hr_0900_as_cs	utf8mb4	298		Yes	8	Alias for utf8mb4_uca1400_croatian_nopad_as_cs
utf8mb4_vi_0900_as_cs	utf8mb4	300		Yes	8	Alias for utf8mb4_uca1400_vietnamese_nopad_as_cs
utf8mb4_0900_as_ci	utf8mb4	305		Yes	8	Alias for utf8mb4_uca1400_nopad_as_ci
utf8mb4_0900_bin	utf8mb4	309		Yes	1	Alias for utf8mb4_nopad_bin
#
# MDEV-20912 Add support for utf8mb4_0900_* collations in MariaDB Server
#
CREATE DATABASE db1 CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
USE db1;
CREATE TABLE t1 (a VARCHAR(10) CHARACTER SET latin1);
ALTER TABLE t1 CONVERT TO CHARACTER SET DEFAULT COLLATE utf8mb4_0900_ai_ci;
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` varchar(10) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
DROP TABLE t1;
CREATE TABLE t1 (a VARCHAR(10) CHARACTER SET latin1);
ALTER TABLE t1 CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_sv_0900_ai_ci;
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` varchar(10) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_sv_0900_ai_ci
DROP TABLE t1;
DROP DATABASE db1;
USE test;
#
# CREATE TABLE - table level character set and collation
#
CREATE DATABASE db1 CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
CREATE TABLE db1.t1 (a CHAR(1)) COLLATE utf8mb4_0900_ai_ci;
SHOW CREATE TABLE db1.t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` char(1) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
ALTER TABLE db1.t1 modify a CHAR(1) COLLATE utf8mb4_sv_0900_ai_ci;
SHOW CREATE TABLE db1.t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` char(1) CHARACTER SET utf8mb4 COLLATE utf8mb4_sv_0900_ai_ci DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
DROP TABLE db1.t1;
CREATE TABLE db1.t1 (a CHAR(1)) COLLATE utf8mb4_sv_0900_ai_ci;
SHOW CREATE TABLE db1.t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` char(1) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_sv_0900_ai_ci
DROP TABLE db1.t1;
CREATE TABLE db1.t1 (a CHAR(1)) CHARACTER SET DEFAULT COLLATE utf8mb4_0900_ai_ci;
SHOW CREATE TABLE db1.t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` char(1) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
DROP TABLE db1.t1;
DROP DATABASE db1;
#
# Ensure that we can seamlessly compare and move between
# utf8mb4_sv_0900_ai_ci and utf8mb4_uca1400_swedish_1400_nopad_ai_ci
#
CREATE TABLE t1 (p int primary key auto_increment, a VARCHAR(10), key (a)) engine=innodb, COLLATE utf8mb4_sv_0900_ai_ci;
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `p` int(11) NOT NULL AUTO_INCREMENT,
  `a` varchar(10) DEFAULT NULL,
  PRIMARY KEY (`p`),
  KEY `a` (`a`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_sv_0900_ai_ci
CREATE TABLE t2 (p int primary key auto_increment, a VARCHAR(10), key(a)) engine=innodb, COLLATE utf8mb4_uca1400_swedish_nopad_ai_ci;
show create table t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `p` int(11) NOT NULL AUTO_INCREMENT,
  `a` varchar(10) DEFAULT NULL,
  PRIMARY KEY (`p`),
  KEY `a` (`a`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_uca1400_swedish_nopad_ai_ci
insert into t1 (a) values ("hello"),("world");
insert into t2 (a) values ("hello"),("world");
explain select * from t1,t2 where t1.a=t2.a;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	a	a	43	NULL	2	Using where; Using index
1	SIMPLE	t2	ref	a	a	43	test.t1.a	1	Using where; Using index
# Check that alter table can convert between the character sets
alter table t1 modify a varchar(10) collate utf8mb4_uca1400_swedish_nopad_ai_ci, algorithm=nocopy;
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `p` int(11) NOT NULL AUTO_INCREMENT,
  `a` varchar(10) CHARACTER SET utf8mb4 COLLATE utf8mb4_uca1400_swedish_nopad_ai_ci DEFAULT NULL,
  PRIMARY KEY (`p`),
  KEY `a` (`a`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_sv_0900_ai_ci
alter table t2 modify a varchar(10) collate utf8mb4_sv_0900_ai_ci, algorithm=nocopy;
show create table t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `p` int(11) NOT NULL AUTO_INCREMENT,
  `a` varchar(10) CHARACTER SET utf8mb4 COLLATE utf8mb4_sv_0900_ai_ci DEFAULT NULL,
  PRIMARY KEY (`p`),
  KEY `a` (`a`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_uca1400_swedish_nopad_ai_ci
drop table t1,t2;
CREATE OR REPLACE TABLE t1 (p int primary key auto_increment, a VARCHAR(10), key (a)) engine=aria, COLLATE utf8mb4_sv_0900_ai_ci;
alter table t1 modify a varchar(10) collate utf8mb4_uca1400_swedish_nopad_ai_ci, algorithm=nocopy;
drop table t1;
#
# MDEV-36361 Wrong utf8mb4_0900_bin alias for utf8mb4_bin (should be utf8mb4_nopad_bin)
#
SELECT collation_name, id, comment
FROM information_schema.collations
WHERE collation_name='utf8mb4_0900_bin';
collation_name	id	comment
utf8mb4_0900_bin	309	Alias for utf8mb4_nopad_bin
CREATE TABLE t1 (
a VARCHAR(32),
b VARCHAR(32)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_bin;
INSERT INTO t1 VALUES ('a\t', 'a');
SELECT a<b FROM t1;
a<b
0
DROP TABLE t1;
# End of 11.4 tests

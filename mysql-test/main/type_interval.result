#
# Start of 10.4 tests
#
#
# MDEV-17776 CAST(x AS INTERVAL DAY_SECOND(N))
#
CREATE TABLE t1 (a VARCHAR(128));
INSERT INTO t1 VALUES
('00:00:00'),
('+00:00:01'),
('-00:00:01'),
('838:59:59'),
('839:00:00'),
('2018:01:02'),
('87649415:59:59'),
('3652058 23:59:59'),
('87649416:00:00'),
('3652059 00:00:00');
SELECT
EXTRACT(DAY FROM a) AS d,
EXTRACT(HOUR FROM a) AS h,
a,
CAST(a AS INTERVAL DAY_SECOND(6)) AS cast_itds
FROM t1;
d	h	a	cast_itds
0	0	00:00:00	00:00:00.000000
0	0	+00:00:01	00:00:01.000000
0	0	-00:00:01	-00:00:01.000000
34	22	838:59:59	34 22:59:59.000000
34	23	839:00:00	34 23:00:00.000000
84	2	2018:01:02	84 02:01:02.000000
3652058	23	87649415:59:59	3652058 23:59:59.000000
3652058	23	3652058 23:59:59	3652058 23:59:59.000000
NULL	NULL	87649416:00:00	NULL
NULL	NULL	3652059 00:00:00	NULL
Warnings:
Warning	1292	Incorrect interval value: '87649416:00:00'
Warning	1292	Incorrect interval value: '87649416:00:00'
Warning	1292	Incorrect INTERVAL DAY TO SECOND value: '87649416:00:00'
Warning	1292	Incorrect interval value: '3652059 00:00:00'
Warning	1292	Incorrect interval value: '3652059 00:00:00'
Warning	1292	Incorrect INTERVAL DAY TO SECOND value: '3652059 00:00:00'
DROP TABLE t1;
CREATE TABLE t1 (a DECIMAL(32,9));
INSERT INTO t1 VALUES
(0),
(1),
(-1),
(8385959),
(8390000),
(20180102),
(876494155959),
(876494160000);
SELECT
EXTRACT(DAY FROM a) AS d,
EXTRACT(HOUR FROM a) AS h,
a,
CAST(a AS INTERVAL DAY_SECOND(6)) AS cast_itds
FROM t1;
d	h	a	cast_itds
0	0	0.000000000	00:00:00.000000
0	0	1.000000000	00:00:01.000000
0	0	-1.000000000	-00:00:01.000000
34	22	8385959.000000000	34 22:59:59.000000
34	23	8390000.000000000	34 23:00:00.000000
84	2	20180102.000000000	84 02:01:02.000000
3652058	23	876494155959.000000000	3652058 23:59:59.000000
NULL	NULL	876494160000.000000000	NULL
Warnings:
Note	1292	Truncated incorrect INTERVAL DAY TO SECOND value: '0.000000000'
Note	1292	Truncated incorrect INTERVAL DAY TO SECOND value: '1.000000000'
Note	1292	Truncated incorrect INTERVAL DAY TO SECOND value: '-1.000000000'
Note	1292	Truncated incorrect INTERVAL DAY TO SECOND value: '8385959.000000000'
Note	1292	Truncated incorrect INTERVAL DAY TO SECOND value: '8390000.000000000'
Note	1292	Truncated incorrect INTERVAL DAY TO SECOND value: '20180102.000000000'
Note	1292	Truncated incorrect INTERVAL DAY TO SECOND value: '876494155959.000000000'
Warning	1292	Incorrect interval value: '876494160000.000000000' for column `test`.`t1`.`a` at row 8
Warning	1292	Incorrect interval value: '876494160000.000000000' for column `test`.`t1`.`a` at row 8
Warning	1292	Incorrect INTERVAL DAY TO SECOND value: '876494160000.000000000'
DROP TABLE t1;
#
# End of 10.4 tests
#
#
# MDEV-12513: Support for INTERVAL data types in MariaDB
#
CREATE PROCEDURE sp_interval_parameters(
IN in_ym INTERVAL YEAR(4) TO MONTH,        -- Max: 9999-11
IN in_y INTERVAL YEAR(4),                  -- Max: 9999
IN in_m INTERVAL MONTH(2),                 -- Max: 99
IN in_ds INTERVAL DAY(3) TO SECOND(6),     -- Max: 999 23:59:59.999999
IN in_d INTERVAL DAY(3),                   -- Max: 999
IN in_h INTERVAL HOUR(3),                  -- Max: 999
IN in_n INTERVAL MINUTE(2),                -- Max: 99
IN in_s INTERVAL SECOND(6),                -- Max: 59.999999
IN in_dh INTERVAL DAY(3) TO HOUR,          -- Max: 999 23
IN in_dm INTERVAL DAY(3) TO MINUTE,        -- Max: 999 23:59
IN in_hs INTERVAL HOUR(3) TO SECOND(6),    -- Max: 999:59:59.999999
IN in_hm INTERVAL HOUR(3) TO MINUTE,       -- Max: 999:59
IN in_ms INTERVAL MINUTE(2) TO SECOND(6),  -- Max: 99:59.999999
OUT out_ym INTERVAL YEAR(4) TO MONTH,
OUT out_y INTERVAL YEAR(4),
OUT out_m INTERVAL MONTH(2),
OUT out_ds INTERVAL DAY(3) TO SECOND(6),
OUT out_d INTERVAL DAY(3),
OUT out_h INTERVAL HOUR(3),
OUT out_n INTERVAL MINUTE(2),
OUT out_s INTERVAL SECOND(6),
OUT out_dh INTERVAL DAY(3) TO HOUR,
OUT out_dm INTERVAL DAY(3) TO MINUTE,
OUT out_hs INTERVAL HOUR(3) TO SECOND(6),
OUT out_hm INTERVAL HOUR(3) TO MINUTE,
OUT out_ms INTERVAL MINUTE(2) TO SECOND(6)
)
BEGIN
-- Simple passthrough logic
SET out_ym = in_ym;
SET out_y = in_y;
SET out_m = in_m;
SET out_ds = in_ds;
SET out_d = in_d;
SET out_h = in_h;
SET out_n = in_n;
SET out_s = in_s;
SET out_dh = in_dh;
SET out_dm = in_dm;
SET out_hs = in_hs;
SET out_hm = in_hm;
SET out_ms = in_ms;
END;
/
CALL sp_interval_parameters(
'5-3',
'10',
'12',
'100 12:30:45.123456',
'100',
'120',
'90',
'45.123456',
'100 12',
'100 12:30',
'120:30:45.123456',
'120:30',
'90:45.123456',
@out_ym, @out_y, @out_m, @out_ds, @out_d,
@out_h, @out_n, @out_s, @out_dh, @out_dm,
@out_hs, @out_hm, @out_ms
);
SELECT
@out_ym,
@out_y,
@out_m,
@out_ds,
@out_d,
@out_h,
@out_n,
@out_s,
@out_dh,
@out_dm,
@out_hs,
@out_hm,
@out_ms;
@out_ym	@out_y	@out_m	@out_ds	@out_d	@out_h	@out_n	@out_s	@out_dh	@out_dm	@out_hs	@out_hm	@out_ms
5-03	10	12	100 12:30:45.123456	100	120	90	45.123456	100 12	100 12:30	120:30:45.123456	120:30	90:45.123456
drop procedure sp_interval_parameters;
Parser Validation - Unsupported Interval Types & Invalid combination of INTERVAL Range.
CREATE PROCEDURE sp_invalid1(IN a INTERVAL QUARTER) BEGIN END;
ERROR 42000: This version of MariaDB doesn't yet support 'INTERVAL QUARTER'
CREATE PROCEDURE sp_invalid2(IN a INTERVAL WEEK) BEGIN END;
ERROR 42000: This version of MariaDB doesn't yet support 'INTERVAL WEEK'
CREATE PROCEDURE sp_invalid3(IN a INTERVAL MICROSECOND) BEGIN END;
ERROR 42000: This version of MariaDB doesn't yet support 'INTERVAL MICROSECOND'
CREATE PROCEDURE sp_invalid4(IN a INTERVAL DAY TO MICROSECOND) BEGIN END;
ERROR 42000: This version of MariaDB doesn't yet support 'INTERVAL DAY TO MICROSECOND'
CREATE PROCEDURE sp_invalid5(IN a INTERVAL HOUR TO MICROSECOND) BEGIN END;
ERROR 42000: This version of MariaDB doesn't yet support 'INTERVAL HOUR TO MICROSECOND'
CREATE PROCEDURE sp_invalid6(IN a INTERVAL MINUTE TO MICROSECOND) BEGIN END;
ERROR 42000: This version of MariaDB doesn't yet support 'INTERVAL MINUTE TO MICROSECOND'
CREATE PROCEDURE sp_invalid7(IN a INTERVAL SECOND TO MICROSECOND) BEGIN END;
ERROR 42000: This version of MariaDB doesn't yet support 'INTERVAL SECOND TO MICROSECOND'
CREATE PROCEDURE sp_invalid8(IN a INTERVAL MICROSECOND TO SECOND) BEGIN END;
ERROR HY000: Invalid INTERVAL range combination
CREATE PROCEDURE sp_invalid11(IN a INTERVAL MICROSECOND TO MINUTE) BEGIN END;
ERROR HY000: Invalid INTERVAL range combination
CREATE PROCEDURE sp_invalid12(IN a INTERVAL YEAR TO SECOND) BEGIN END;
ERROR HY000: Invalid INTERVAL range combination
CREATE PROCEDURE sp_invalid13(IN a INTERVAL MONTH TO DAY) BEGIN END;
ERROR HY000: Invalid INTERVAL range combination
CREATE PROCEDURE sp_invalid14(IN a INTERVAL SECOND TO HOUR) BEGIN END;
ERROR HY000: Invalid INTERVAL range combination
CREATE PROCEDURE sp_invalid15(IN a INTERVAL WEEK TO DAY) BEGIN END;
ERROR HY000: Invalid INTERVAL range combination
CREATE PROCEDURE sp_invalid16(IN a INTERVAL YEAR TO SECOND) BEGIN END;
ERROR HY000: Invalid INTERVAL range combination
Precision validation â€“ ensuring valid start and end precisions
CREATE PROCEDURE sp_invalid_1(IN a INTERVAL YEAR(5)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 4
CREATE PROCEDURE sp_invalid_2(IN a INTERVAL MONTH(7)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 6
CREATE PROCEDURE sp_invalid_3(IN a INTERVAL DAY(8)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 7
CREATE PROCEDURE sp_invalid_4(IN a INTERVAL HOUR(10)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 8
CREATE PROCEDURE sp_invalid_5(IN a INTERVAL MINUTE(11)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 10
CREATE PROCEDURE sp_invalid_6(IN a INTERVAL SECOND(13)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 6
CREATE PROCEDURE sp_invalid_7(IN a INTERVAL YEAR(8)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 4
CREATE PROCEDURE sp_invalid_8(IN a INTERVAL SECOND(13)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 6
CREATE PROCEDURE sp_invalid_9(IN a INTERVAL DAY(9) TO SECOND(3)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 7
CREATE PROCEDURE sp_invalid_10(IN a INTERVAL HOUR(4) TO SECOND(13)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 6
CREATE PROCEDURE sp_invalid_11(IN a INTERVAL MINUTE(11) TO SECOND(2)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 10
CREATE PROCEDURE sp_invalid_12(IN a INTERVAL DAY(12) TO SECOND(2)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 7
CREATE PROCEDURE sp_invalid_13(IN a INTERVAL HOUR(3) TO SECOND(13)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 6
CREATE PROCEDURE sp_invalid_14(IN a INTERVAL DAY(12) TO SECOND(3)) BEGIN END;
ERROR 42000: Too big precision specified for 'a'. Maximum is 7
CREATE PROCEDURE sp_valid_1(IN a INTERVAL YEAR(4))
BEGIN
SELECT a;
END /
CALL sp_valid_1('9999');
a
9999
CALL sp_Valid_1('1');
a
1
CALL sp_Valid_1('0');
a
0
CALL sp_Valid_1(9999);
a
9999
CALL sp_Valid_1(123);
a
123
CALL sp_Valid_1(0.1234e4);
a
1234
CALL sp_valid_1('10000');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_1;
CREATE PROCEDURE sp_valid_2(IN a INTERVAL MONTH(6))
BEGIN
SELECT a;
END /
CALL sp_valid_2('119988');
a
119988
CALL sp_valid_2(0.119988e6);
a
119988
CALL sp_valid_2(0);
a
0
CALL sp_valid_2('1200000');
ERROR HY000: Default/ignore value is not supported for such parameter usage
CALL sp_valid_2(0.119988e7);
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_2;
CREATE PROCEDURE sp_valid_3(IN a INTERVAL DAY(7))
BEGIN
SELECT a;
END /
CALL sp_valid_3('3719628');
a
3719628
CALL sp_valid_3(3719628);
a
3719628
CALL sp_valid_3(0.3719628e7);
a
3719628
CALL sp_valid_3('40000000');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_3;
CREATE PROCEDURE sp_valid_4(IN a INTERVAL HOUR(8))
BEGIN
SELECT a;
END /
CALL sp_valid_4('89271072');
a
89271072
CALL sp_valid_4(89271072);
a
89271072
CALL sp_valid_4(0.89271072e8);
a
89271072
CALL sp_valid_4('100000000');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_4;
CREATE PROCEDURE sp_valid_5(IN a INTERVAL MINUTE(10))
BEGIN
SELECT a;
END /
CALL sp_valid_5('5266993248');
a
5266993248
CALL sp_valid_5(5266993248);
a
5266993248
CALL sp_valid_5(52669.93248e5);
a
5266993248
CALL sp_valid_5('99999999999');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_5;
CREATE PROCEDURE sp_valid_6(IN a INTERVAL SECOND(3))
BEGIN
SELECT a;
END /
CALL sp_valid_6('59.123');
a
59.123000
CALL sp_valid_6(59.123);
a
59.123000
CALL sp_valid_6(59123e-3);
a
59.122000
CALL sp_valid_6(15646.1232);
a
15646.123000
CALL sp_valid_6(15646.1232e0);
a
15646.123000
CALL sp_valid_6(15646.123255);
a
15646.123000
set SQL_MODE = 'TIME_ROUND_FRACTIONAL';
CALL sp_valid_6('59.1236');
a
59.124000
CALL sp_valid_6('59.1299');
a
59.130000
DROP PROCEDURE sp_valid_6;
CREATE PROCEDURE sp_valid_7(IN a INTERVAL YEAR(2))
BEGIN
SELECT a;
END /
CALL sp_valid_7('99');
a
99
CALL sp_valid_7('0');
a
0
CALL sp_valid_7(99);
a
99
CALL sp_valid_7(0.99e2);
a
99
CALL sp_valid_7(0.99e3);
ERROR HY000: Default/ignore value is not supported for such parameter usage
CALL sp_valid_7('1234');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_7;
CREATE PROCEDURE sp_valid_8(IN a INTERVAL MONTH(1))
BEGIN
SELECT a;
END /
CALL sp_valid_8('1');
a
1
CALL sp_valid_8('9');
a
9
CALL sp_valid_8('0');
a
0
CALL sp_valid_8('7');
a
7
CALL sp_valid_8(0.7e1);
a
7
CALL sp_valid_8(70e-1);
a
7
CALL sp_valid_8('11');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_8;
CREATE PROCEDURE sp_valid_9(IN a INTERVAL DAY(3))
BEGIN
SELECT a;
END /
CALL sp_valid_9('999');
a
999
CALL sp_valid_9('10000');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_9;
CREATE PROCEDURE sp_valid_10(IN a INTERVAL MINUTE(7))
BEGIN
SELECT a;
END /
CALL sp_valid_10('9999999');
a
9999999
CALL sp_valid_10(9999999);
a
9999999
CALL sp_valid_10('12345678');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_10;
CREATE PROCEDURE sp_valid_11(IN a INTERVAL DAY(2) TO SECOND(3))
BEGIN
SELECT a;
END /
CALL sp_valid_11('99 23:59:59.999');
a
99 23:59:59.999000
CALL sp_valid_11(99235959.999);
a
99 23:59:59.999000
CALL sp_valid_11(99235959999e-3);
a
99 23:59:59.999000
CALL sp_valid_11('100 23:59:59.999');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_11;
CREATE PROCEDURE sp_valid_12(IN a INTERVAL HOUR(3) TO SECOND(6))
BEGIN
SELECT a;
END /
CALL sp_valid_12('999:59:59.999999');
a
999:59:59.999999
CALL sp_valid_12('1000:59:59.999999');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_12;
CREATE PROCEDURE sp_valid_13(IN a INTERVAL MINUTE(5) TO SECOND(4))
BEGIN
SELECT a;
END /
CALL sp_valid_13('99999:59.9999');
a
99999:59.999900
CALL sp_valid_13('100000:59.9999');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_13;
CREATE PROCEDURE sp_valid_14(IN a INTERVAL DAY(1) TO MINUTE)
BEGIN
SELECT a;
END /
CALL sp_valid_14('9 23:59');
a
9 23:59
CALL sp_valid_14('99 23:59');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_14;
CREATE PROCEDURE sp_valid_15(IN a INTERVAL HOUR(8) TO MINUTE)
BEGIN
SELECT a;
END /
CALL sp_valid_15('99999999:59');
a
99999999:59
CALL sp_valid_15('100000000:59');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_15;
CREATE PROCEDURE sp_valid_16(IN a INTERVAL DAY TO SECOND(6))
BEGIN
SELECT a;
END /
CALL sp_valid_16('9 23:59:59.999999');
a
9 23:59:59.999999
CALL sp_valid_16('100 23:59:59.999999');
a
100 23:59:59.999999
DROP PROCEDURE sp_valid_16;
CREATE PROCEDURE sp_valid_17(IN a INTERVAL HOUR(4) TO SECOND)
BEGIN
SELECT a;
END /
CALL sp_valid_17('23:59:59');
a
23:59:59
CALL sp_valid_17('10000:59:59');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_17;
CREATE PROCEDURE sp_valid_18(IN a INTERVAL MINUTE(9) TO SECOND(2))
BEGIN
SELECT a;
END /
CALL sp_valid_18('999999999:59.99');
a
999999999:59.990000
CALL sp_valid_18('1000000000:59.99');
ERROR HY000: Default/ignore value is not supported for such parameter usage
DROP PROCEDURE sp_valid_18;
CREATE PROCEDURE sp_valid_19(IN a INTERVAL HOUR TO SECOND(5))
BEGIN
SELECT a;
END /
CALL sp_valid_19('23:59:59.99999');
a
23:59:59.999990
CALL sp_valid_19('1000:59:59.99999');
a
1000:59:59.999990
DROP PROCEDURE sp_valid_19;
SELECT TIME '12:00:00'            + INTERVAL '1'       HOUR            AS basic_hour;
basic_hour
13:00:00
SELECT TIME '23:30:00'            + INTERVAL '45'      MINUTE          AS rollover_minute;
rollover_minute
24:15:00
SELECT TIME '12:00:00'            + INTERVAL '90'      SECOND          AS second_addition;
second_addition
12:01:30
SELECT TIME '12:00:00.5'          + INTERVAL '0.5'     SECOND          AS fractional_add;
fractional_add
12:00:01
SELECT TIME '23:59:59.999999'     + INTERVAL '0.000001' SECOND          AS micro_rollover;
micro_rollover
24:00:00
SELECT TIME '12:00:00'            + INTERVAL '-1'      HOUR            AS negative_hour;
negative_hour
11:00:00
SELECT TIME '01:00:00'            + INTERVAL '-90'     MINUTE          AS negative_minute;
negative_minute
-00:30:00
SELECT TIME '12:00:00'            + INTERVAL '1'       DAY             AS day_addition;
day_addition
36:00:00
SELECT TIME '12:00:00'            + INTERVAL '2 12'    DAY TO HOUR     AS day_to_hour;
day_to_hour
72:00:00
SELECT TIME '12:00:00'            + INTERVAL '1 12:30:05' DAY TO SECOND AS day_to_second;
day_to_second
48:30:05
SELECT TIME '12:00:00'            + INTERVAL '25:30:05'  HOUR TO SECOND AS hour_to_second;
hour_to_second
37:30:05
SELECT TIME '12:00:00'            + INTERVAL '90:05'     MINUTE TO SECOND AS minute_to_second;
minute_to_second
13:30:05
SELECT TIME '838:59:59'           + INTERVAL '1'       SECOND          AS time_overflow;
time_overflow
838:00:00
SELECT TIME '-838:59:59'          + INTERVAL '-1'      SECOND          AS time_underflow;
time_underflow
-838:00:00
SELECT TIME '12:00:00'            + INTERVAL '0.0000001' SECOND         AS precision_overflow;
precision_overflow
12:00:00
SELECT TIME '12:00:00'            + INTERVAL '1'       HOUR            + INTERVAL '30' MINUTE            AS no_parens;
no_parens
13:30:00
SELECT TIME '12:00:00'            + INTERVAL '1'       HOUR            - INTERVAL '15' MINUTE            AS mixed_ops;
mixed_ops
12:45:00
SELECT TIME '12:00:00'            + INTERVAL '1'       YEAR            AS invalid_year;
invalid_year
0001-00-00 12:00:00
SELECT TIME '12:00:00'            + INTERVAL '1'       MONTH           AS invalid_month;
invalid_month
0000-01-00 12:00:00
SELECT TIME '12:00:00.499999'     + INTERVAL '0.5000001' SECOND         AS rounding1;
rounding1
12:00:00
SELECT TIME '12:00:00.499999'     + INTERVAL '0.500001'  SECOND         AS rounding2;
rounding2
12:00:01
SELECT TIME '12:00:00'            + INTERVAL '0.000001' SECOND(6)       AS max_precision;
max_precision
12:00:00
SELECT TIME '-12:00:00'           + INTERVAL '1'       HOUR            AS negative_base;
negative_base
-11:00:00
SELECT TIME '-00:30:00'           + INTERVAL '90'      MINUTE          AS negative_to_positive;
negative_to_positive
01:00:00
SELECT TIME '00:00:00'            + INTERVAL '59:59.999999' MINUTE TO SECOND(6) AS max_fractional;
max_fractional
00:59:59
SELECT TIME '23:59:59'            + INTERVAL '1.000001' SECOND(6)       AS second_rollover;
second_rollover
24:00:00
SELECT TIME '12:00:00'            + INTERVAL '36'      HOUR            AS multi_day;
multi_day
48:00:00
SELECT TIME '00:00:00'            + INTERVAL '47:59:59' HOUR TO SECOND  AS max_valid;
max_valid
47:59:59
SELECT TIME '12:00:00'            + INTERVAL '1'       HOUR            AS step1, (TIME '12:00:00' + INTERVAL '1' HOUR) + INTERVAL '30' MINUTE AS chained;
step1	chained
13:00:00	13:30:00
SELECT DATE '2025-01-01'          - INTERVAL '5'       YEAR;
DATE '2025-01-01'          - INTERVAL '5'       YEAR
2020-01-01
SELECT DATE '2025-01-31'          + INTERVAL '1'       MONTH;
DATE '2025-01-31'          + INTERVAL '1'       MONTH
2025-02-28
SELECT DATE '2025-07-01'          + INTERVAL '31'      DAY;
DATE '2025-07-01'          + INTERVAL '31'      DAY
2025-08-01
SELECT DATE '2025-01-31'          + INTERVAL '0-1'     YEAR TO MONTH;
DATE '2025-01-31'          + INTERVAL '0-1'     YEAR TO MONTH
2025-02-28
SELECT DATE '2025-12-15'          - INTERVAL '2-4'     YEAR TO MONTH;
DATE '2025-12-15'          - INTERVAL '2-4'     YEAR TO MONTH
2023-08-15
SELECT DATE '2025-01-01'          + INTERVAL '1 6'     DAY TO HOUR;
DATE '2025-01-01'          + INTERVAL '1 6'     DAY TO HOUR
2025-01-02 06:00:00
SELECT DATE '2025-01-01'          + INTERVAL '1:30'    HOUR TO MINUTE;
DATE '2025-01-01'          + INTERVAL '1:30'    HOUR TO MINUTE
2025-01-01 01:30:00
SELECT DATE '2024-02-29'          + INTERVAL '4'       YEAR;
DATE '2024-02-29'          + INTERVAL '4'       YEAR
2028-02-29
SELECT DATE '2025-01-01'          + INTERVAL NULL      DAY;
DATE '2025-01-01'          + INTERVAL NULL      DAY
NULL
SELECT NULL                       + INTERVAL '1'       MONTH;
NULL                       + INTERVAL '1'       MONTH
NULL
SELECT DATE '2025-01-01'          + INTERVAL '1'       DAY             + INTERVAL '1' MONTH;
DATE '2025-01-01'          + INTERVAL '1'       DAY             + INTERVAL '1' MONTH
2025-02-02
SELECT DATE '2025-01-03'          - INTERVAL '1'       DAY             - INTERVAL '2' MONTH;
DATE '2025-01-03'          - INTERVAL '1'       DAY             - INTERVAL '2' MONTH
2024-11-02
SELECT DATE '2025-01-31'          + INTERVAL '99'      MONTH;
DATE '2025-01-31'          + INTERVAL '99'      MONTH
2033-04-30
SELECT DATE '2025-01-01'          + INTERVAL '1'       YEAR            + INTERVAL '1' MONTH;
DATE '2025-01-01'          + INTERVAL '1'       YEAR            + INTERVAL '1' MONTH
2026-02-01
SELECT (DATE '2025-01-01' + INTERVAL '6' MONTH) + INTERVAL '3' DAY;
(DATE '2025-01-01' + INTERVAL '6' MONTH) + INTERVAL '3' DAY
2025-07-04
SELECT TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '100-6'   YEAR TO MONTH AS large_year_month;
large_year_month
2126-02-01 00:00:00
SELECT TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '10000 12' DAY TO HOUR    AS large_day_to_hour;
large_day_to_hour
2052-12-17 12:00:00
SELECT TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '50000:59:59' HOUR TO SECOND AS large_hour_to_second;
large_hour_to_second
2031-04-15 08:59:59
SELECT TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '1000000:30' MINUTE TO SECOND AS large_minute_to_second;
large_minute_to_second
2027-06-26 10:40:30
SELECT TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '1 12:30:15' DAY TO SECOND   AS day_to_second;
day_to_second
2025-08-02 12:30:15
SELECT TIMESTAMP '2025-08-01 05:00:00' + INTERVAL '2:45'       HOUR TO MINUTE   AS hour_to_minute;
hour_to_minute
2025-08-01 07:45:00
SELECT TIMESTAMP '2025-08-01 05:00:00' + INTERVAL '90:30'      MINUTE TO SECOND AS minute_to_second;
minute_to_second
2025-08-01 06:30:30
SELECT TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '1-3'       YEAR TO MONTH    AS year_to_month;
year_to_month
2026-11-01 00:00:00
SELECT TIMESTAMP '2025-08-01 05:00:00' + INTERVAL '2 4'       DAY TO HOUR      AS day_to_hour;
day_to_hour
2025-08-03 09:00:00
SELECT TIME '12:00:00' - INTERVAL '-1' HOUR AS basic_hour;
basic_hour
13:00:00
SELECT TIME '23:30:00' + INTERVAL '45' MINUTE AS rollover_minute;
rollover_minute
24:15:00
SELECT INTERVAL '90' SECOND + TIME '12:00:00' AS second_addition;
second_addition
12:01:30
SELECT INTERVAL '0.5' SECOND + TIME '12:00:00.5' AS fractional_add;
fractional_add
12:00:01
SELECT TIME '23:59:59.999999' - INTERVAL '-0.000001' SECOND AS micro_rollover;
micro_rollover
24:00:00
SELECT TIME '12:00:00' + INTERVAL '-1' HOUR AS negative_hour;
negative_hour
11:00:00
SELECT INTERVAL '-90' MINUTE + TIME '01:00:00' AS negative_minute;
negative_minute
-00:30:00
SELECT INTERVAL '1' DAY + TIME '12:00:00' AS day_addition;
day_addition
36:00:00
SELECT TIME '12:00:00' + INTERVAL '2 12' DAY TO HOUR AS day_to_hour;
day_to_hour
72:00:00
SELECT INTERVAL '1 12:30:05' DAY TO SECOND + TIME '12:00:00' AS day_to_second;
day_to_second
48:30:05
SELECT INTERVAL '25:30:05' HOUR TO SECOND + TIME '12:00:00' AS hour_to_second;
hour_to_second
37:30:05
SELECT TIME '12:00:00' + INTERVAL '90:05' MINUTE TO SECOND AS minute_to_second;
minute_to_second
13:30:05
SELECT TIME '838:59:59' - INTERVAL '-1' SECOND AS time_overflow;
time_overflow
838:00:00
SELECT TIME '-838:59:59' - INTERVAL '1' SECOND AS time_underflow;
time_underflow
-838:00:00
SELECT TIME '12:00:00' + INTERVAL '0.0000001' SECOND AS precision_overflow;
precision_overflow
12:00:00
SELECT TIME '12:00:00' - INTERVAL '-1' HOUR - INTERVAL '-30' MINUTE AS no_parens;
no_parens
13:30:00
SELECT TIME '12:00:00' - INTERVAL '-1' HOUR - INTERVAL '15' MINUTE AS mixed_ops;
mixed_ops
12:45:00
SELECT INTERVAL '1' YEAR + TIME '12:00:00' AS invalid_year;
invalid_year
0001-00-00 12:00:00
SELECT TIME '12:00:00' + INTERVAL '1' MONTH AS invalid_month;
invalid_month
0000-01-00 12:00:00
SELECT TIME '12:00:00.499999' - INTERVAL '-0.5000001' SECOND AS rounding1;
rounding1
12:00:00
SELECT INTERVAL '0.500001' SECOND + TIME '12:00:00.499999' AS rounding2;
rounding2
12:00:01
SELECT INTERVAL '0.000001' SECOND(6) + TIME '12:00:00' AS max_precision;
max_precision
12:00:00
SELECT TIME '-12:00:00' - INTERVAL '-1' HOUR AS negative_base;
negative_base
-11:00:00
SELECT INTERVAL '90' MINUTE + TIME '-00:30:00' AS negative_to_positive;
negative_to_positive
01:00:00
SELECT TIME '00:00:00' + INTERVAL '59:59.999999' MINUTE TO SECOND(6) AS max_fractional;
max_fractional
00:59:59
SELECT TIME '23:59:59' + INTERVAL '1.000001' SECOND(6) AS second_rollover;
second_rollover
24:00:00
SELECT INTERVAL '36' HOUR + TIME '12:00:00' AS multi_day;
multi_day
48:00:00
SELECT TIME '00:00:00' + INTERVAL '47:59:59' HOUR TO SECOND AS max_valid;
max_valid
47:59:59
SELECT INTERVAL '1' HOUR + TIME '12:00:00' AS step1, (TIME '12:00:00' - INTERVAL '-1' HOUR) - INTERVAL '-30' MINUTE AS chained;
step1	chained
13:00:00	13:30:00
SELECT DATE '2025-01-01' + INTERVAL '-5' YEAR;
DATE '2025-01-01' + INTERVAL '-5' YEAR
2020-01-01
SELECT INTERVAL '1' MONTH + DATE '2025-01-31';
INTERVAL '1' MONTH + DATE '2025-01-31'
2025-02-28
SELECT DATE '2025-07-01' - INTERVAL '-31' DAY;
DATE '2025-07-01' - INTERVAL '-31' DAY
2025-08-01
SELECT DATE '2025-01-31' + INTERVAL '0-1' YEAR TO MONTH;
DATE '2025-01-31' + INTERVAL '0-1' YEAR TO MONTH
2025-02-28
SELECT DATE '2025-12-15' - INTERVAL '2-4' YEAR TO MONTH;
DATE '2025-12-15' - INTERVAL '2-4' YEAR TO MONTH
2023-08-15
SELECT INTERVAL '1 6' DAY TO HOUR + DATE '2025-01-01';
INTERVAL '1 6' DAY TO HOUR + DATE '2025-01-01'
2025-01-02 06:00:00
SELECT DATE '2025-01-01' + INTERVAL '1:30' HOUR TO MINUTE;
DATE '2025-01-01' + INTERVAL '1:30' HOUR TO MINUTE
2025-01-01 01:30:00
SELECT DATE '2024-02-29' - INTERVAL '-4' YEAR;
DATE '2024-02-29' - INTERVAL '-4' YEAR
2028-02-29
SELECT DATE '2025-01-01' + INTERVAL NULL DAY;
DATE '2025-01-01' + INTERVAL NULL DAY
NULL
SELECT NULL + INTERVAL '1' MONTH;
NULL + INTERVAL '1' MONTH
NULL
SELECT DATE '2025-01-03' - INTERVAL '1' DAY - INTERVAL '2' MONTH;
DATE '2025-01-03' - INTERVAL '1' DAY - INTERVAL '2' MONTH
2024-11-02
SELECT DATE '2025-01-01' - INTERVAL '-1' DAY - INTERVAL '-1' MONTH;
DATE '2025-01-01' - INTERVAL '-1' DAY - INTERVAL '-1' MONTH
2025-02-02
SELECT DATE '2025-01-31' + INTERVAL '99' MONTH;
DATE '2025-01-31' + INTERVAL '99' MONTH
2033-04-30
SELECT DATE '2025-01-01' - INTERVAL '-1' YEAR - INTERVAL '-1' MONTH;
DATE '2025-01-01' - INTERVAL '-1' YEAR - INTERVAL '-1' MONTH
2026-02-01
SELECT (DATE '2025-01-01' - INTERVAL '-6' MONTH) - INTERVAL '-3' DAY;
(DATE '2025-01-01' - INTERVAL '-6' MONTH) - INTERVAL '-3' DAY
2025-07-04
SELECT TIMESTAMP '2025-08-01 00:00:00' - INTERVAL '-100-6' YEAR TO MONTH AS large_year_month;
large_year_month
2126-02-01 00:00:00
SELECT INTERVAL '10000 12' DAY TO HOUR + TIMESTAMP '2025-08-01 00:00:00' AS large_day_to_hour;
large_day_to_hour
2052-12-17 12:00:00
SELECT TIMESTAMP '2025-08-01 00:00:00' - INTERVAL '-50000:59:59' HOUR TO SECOND AS large_hour_to_second;
large_hour_to_second
2031-04-15 08:59:59
SELECT INTERVAL '1000000:30' MINUTE TO SECOND + TIMESTAMP '2025-08-01 00:00:00' AS large_minute_to_second;
large_minute_to_second
2027-06-26 10:40:30
SELECT TIMESTAMP '2025-08-01 00:00:00' - INTERVAL '-1 12:30:15' DAY TO SECOND AS day_to_second;
day_to_second
2025-08-02 12:30:15
SELECT TIMESTAMP '2025-08-01 05:00:00' + INTERVAL '2:45' HOUR TO MINUTE AS hour_to_minute;
hour_to_minute
2025-08-01 07:45:00
SELECT TIMESTAMP '2025-08-01 05:00:00' + INTERVAL '90:30' MINUTE TO SECOND AS minute_to_second;
minute_to_second
2025-08-01 06:30:30
SELECT TIMESTAMP '2025-08-01 00:00:00' - INTERVAL '-1-3' YEAR TO MONTH AS year_to_month;
year_to_month
2026-11-01 00:00:00
SELECT INTERVAL '2 4' DAY TO HOUR + TIMESTAMP '2025-08-01 05:00:00' AS day_to_hour;
day_to_hour
2025-08-03 09:00:00
CREATE PROCEDURE add_year_month(
IN base_date DATE,
IN add_interval INTERVAL YEAR TO MONTH
)
BEGIN
SELECT base_date + add_interval AS result;
END /
CALL add_year_month('2025-01-15', INTERVAL '1-3' YEAR TO MONTH);
result
2026-04-15
CALL add_year_month('2025-01-15', INTERVAL '5-0' YEAR TO MONTH);
result
2030-01-15
CALL add_year_month('2025-01-15', INTERVAL '-2-0' YEAR TO MONTH);
result
2023-01-15
DROP PROCEDURE add_year_month;
CREATE PROCEDURE modify_timestamp(
INOUT base_timestamp TIMESTAMP,
IN modify_interval INTERVAL DAY TO SECOND
)
BEGIN
SET base_timestamp = base_timestamp + modify_interval;
END /
SET @ts1 = '2025-08-01 14:30:00';
CALL modify_timestamp(@ts1, INTERVAL '1 03:15:30.125' DAY TO SECOND);
SELECT @ts1;
@ts1
2025-08-02 17:45:30
SET @ts2 = '2025-08-01 14:30:00';
CALL modify_timestamp(@ts2, -INTERVAL '27 00:30:00' DAY TO SECOND);
SELECT @ts2;
@ts2
2025-07-05 14:00:00
SET @ts3 = '2025-08-01 14:30:00.500';
CALL modify_timestamp(@ts3, INTERVAL '0.500' SECOND);
SELECT @ts3;
@ts3
2025-08-01 14:30:02
DROP PROCEDURE modify_timestamp;
CREATE PROCEDURE adjust_datetime(
INOUT base_datetime DATETIME,
INOUT time_interval INTERVAL HOUR TO MINUTE
)
BEGIN
SET base_datetime = base_datetime + time_interval;
END /
SET @dt1 = '2025-01-01 00:00:00';
SET @iv1 = INTERVAL '02:30' HOUR TO MINUTE;
CALL adjust_datetime(@dt1, @iv1);
SELECT @dt1, @iv1;
@dt1	@iv1
2025-01-01 02:30:00	2:30
SET @dt2 = '2025-01-01 12:00:00';
SET @iv2 = INTERVAL '-01:15' HOUR TO MINUTE;
CALL adjust_datetime(@dt2, @iv2);
SELECT @dt2, @iv2;
@dt2	@iv2
2025-01-01 10:45:00	-1:15
SET @dt3 = '2025-01-01 12:00:00';
SET @iv3 = INTERVAL '00:00' HOUR TO MINUTE;
CALL adjust_datetime(@dt3, @iv3);
SELECT @dt3, @iv3;
@dt3	@iv3
2025-01-01 12:00:00	0:00
DROP PROCEDURE adjust_datetime;
CREATE PROCEDURE mixed_temporal(
IN base_date DATE,
IN time_offset INTERVAL HOUR TO SECOND,
OUT result_datetime DATETIME
)
BEGIN
SET result_datetime = (base_date + INTERVAL '12' HOUR) + time_offset;
END /
SET @result1 = NULL;
CALL mixed_temporal('2025-08-07', INTERVAL '02:15:30.500' HOUR TO SECOND, @result1);
SELECT @result1;
@result1
2025-08-07 14:15:31
SET @result2 = NULL;
CALL mixed_temporal('2025-08-07', INTERVAL '-03:30:00' HOUR TO SECOND, @result2);
SELECT @result2;
@result2
2025-08-07 08:30:00
SET @result3 = NULL;
CALL mixed_temporal('2025-08-07', INTERVAL '22:07:50' HOUR TO SECOND, @result3);
SELECT @result3;
@result3
2025-08-08 10:07:50
DROP PROCEDURE mixed_temporal;
CREATE PROCEDURE handle_negative(
INOUT base_time TIME,
IN neg_interval INTERVAL HOUR TO MINUTE
)
BEGIN
SET base_time = base_time - neg_interval;
END /
SET @time1 = '12:00:00';
CALL handle_negative(@time1, INTERVAL '03:15' HOUR TO MINUTE);
SELECT @time1;
@time1
08:45:00
SET @time2 = '08:30:00';
CALL handle_negative(@time2, INTERVAL '-01:00' HOUR TO MINUTE);
SELECT @time2;
@time2
09:30:00
SET @time3 = '10:00:00';
CALL handle_negative(@time3, INTERVAL '00:00' HOUR TO MINUTE);
SELECT @time3;
@time3
10:00:00
DROP PROCEDURE handle_negative;
SELECT INTERVAL '2' YEAR + INTERVAL '3' YEAR AS yr_yr;
yr_yr
5
SELECT INTERVAL '1' YEAR + INTERVAL '5' MONTH AS yr_mon;
yr_mon
1-05
SELECT INTERVAL '1-3' YEAR TO MONTH + INTERVAL '2-4' YEAR TO MONTH AS comp_ym;
comp_ym
3-07
SELECT INTERVAL '2' DAY + INTERVAL '3' DAY AS day_day;
day_day
5
SELECT INTERVAL '1' DAY + INTERVAL '12' HOUR AS day_hr;
day_hr
1 12
SELECT INTERVAL '1.500' SECOND + INTERVAL '2.750' SECOND AS frac_sec;
frac_sec
4.250000
SELECT INTERVAL '1 12:30:45' DAY TO SECOND + INTERVAL '2 06:15:30' DAY TO SECOND AS comp_dt;
comp_dt
3 18:46:15
SELECT INTERVAL '9999' MONTH + INTERVAL '1' MONTH AS max_mon;
max_mon
10000
SELECT INTERVAL '1' HOUR + INTERVAL '90' MINUTE AS hr_min;
hr_min
2:30
SELECT INTERVAL '5' YEAR + NULL AS null_result, INTERVAL '1' DAY + NULL AS null_dt;
null_result	null_dt
NULL	NULL
SELECT -INTERVAL '2' DAY + -INTERVAL '3' HOUR AS neg_add;
neg_add
-2 03
SELECT -INTERVAL '1' YEAR + INTERVAL '6' MONTH AS neg_ym;
neg_ym
-0-06
SELECT -INTERVAL '1 12:30' DAY TO MINUTE + INTERVAL '45' MINUTE AS neg_comp;
neg_comp
-1 11:45
SELECT -INTERVAL '2-3' YEAR TO MONTH + -INTERVAL '1-4' YEAR TO MONTH AS dbl_neg_ym;
dbl_neg_ym
-3-07
SELECT -INTERVAL '1.5' SECOND + -INTERVAL '0.25' SECOND AS neg_frac;
neg_frac
-1.750000
SELECT INTERVAL '5' YEAR - INTERVAL '18' MONTH AS ym_sub;
ym_sub
3-06
SELECT INTERVAL '2 06:00' DAY TO HOUR - INTERVAL '30:00' HOUR TO MINUTE AS dt_sub;
dt_sub
1 00:00
SELECT INTERVAL '1.500' SECOND - INTERVAL '0.750' SECOND AS frac_sub;
frac_sub
0.750000
SELECT -INTERVAL '3' DAY - -INTERVAL '12' HOUR AS neg_sub;
neg_sub
-2 12
SELECT INTERVAL '1' YEAR - INTERVAL '13' MONTH AS year_boundary;
year_boundary
-0-01
SELECT INTERVAL '1 12' DAY TO HOUR + INTERVAL '3:45' HOUR TO MINUTE AS day_hour_min;
day_hour_min
1 15:45
SELECT INTERVAL '2:30' HOUR TO MINUTE + INTERVAL '45:59.5' MINUTE TO SECOND AS hour_min_sec;
hour_min_sec
3:15:59.500000
SELECT INTERVAL '1 12:30:45' DAY TO SECOND + INTERVAL '3:45:15.5' HOUR TO SECOND AS full_comp;
full_comp
1 16:16:00.500000
SELECT INTERVAL '2-3' YEAR TO MONTH + INTERVAL '5' MONTH AS ym_mon;
ym_mon
2-08
SELECT (INTERVAL '1' DAY - INTERVAL '12' HOUR) + INTERVAL '30:00' MINUTE TO SECOND AS nested;
nested
0 12:30:00
SELECT INTERVAL '9999' YEAR - INTERVAL '1' MONTH AS max_yr_prec;
max_yr_prec
9998-11
SELECT INTERVAL '0.999999' SECOND + INTERVAL '0.000001' SECOND AS frac_overflow;
frac_overflow
1
SELECT INTERVAL '100' DAY + INTERVAL '2400:00' HOUR TO MINUTE AS large_dt;
large_dt
200 00:00
SELECT -INTERVAL '9999' MONTH + INTERVAL '1' YEAR AS neg_boundary;
neg_boundary
-832-03
SELECT INTERVAL '0.000001' SECOND + INTERVAL '0.000002' SECOND AS micro_add;
micro_add
0.3
SELECT -INTERVAL '1-6' YEAR TO MONTH - INTERVAL '3' MONTH AS neg_comp_sub;
neg_comp_sub
-1-09
SELECT INTERVAL '1 12' DAY TO HOUR - INTERVAL '30' MINUTE + INTERVAL '45.5' SECOND AS chain_mix;
chain_mix
1 11:30:45.500000
SELECT -INTERVAL '2:30' HOUR TO MINUTE + -INTERVAL '45:59.5' MINUTE TO SECOND AS neg_chain;
neg_chain
-3:15:59.500000
SELECT (INTERVAL '1' DAY - INTERVAL '12' HOUR) + (INTERVAL '1:30' HOUR TO MINUTE - INTERVAL '00:45' MINUTE TO SECOND) AS multi_op;
multi_op
0 13:29:15
SELECT -(-INTERVAL '2' DAY + -INTERVAL '3' HOUR) AS double_neg;
double_neg
2 03
SELECT INTERVAL '1 06' DAY TO HOUR + INTERVAL '18:30' HOUR TO MINUTE + INTERVAL '00:45.5' MINUTE TO SECOND AS agg;
agg
2 00:30:45.500000
SELECT INTERVAL '10000' DAY + INTERVAL '240000:00' HOUR TO MINUTE - INTERVAL '1 00:00:00.000001' DAY TO SECOND AS extreme;
extreme
19998 23:59:59.999999
SELECT INTERVAL '1 06' DAY TO HOUR + INTERVAL '12:30:45.5' HOUR TO SECOND AS day_hr_sec;
day_hr_sec
1 18:30:45.500000
SELECT INTERVAL '2-8' YEAR TO MONTH - INTERVAL '10' MONTH AS ym_sub;
ym_sub
1-10
SELECT -INTERVAL '3 04:30' DAY TO MINUTE + -INTERVAL '2:45' HOUR TO MINUTE AS neg_comp_add;
neg_comp_add
-3 07:15
SELECT INTERVAL '5:00' HOUR TO MINUTE - INTERVAL '30:15.5' MINUTE TO SECOND AS mixed_qual;
mixed_qual
4:29:44.500000
SELECT INTERVAL '1-2' YEAR TO MONTH + INTERVAL '6' MONTH + INTERVAL '2' YEAR AS chain_ym;
chain_ym
3-08
SELECT -(-INTERVAL '2 12:30' DAY TO MINUTE) AS double_neg;
double_neg
2 12:30
SELECT -INTERVAL '9999' MONTH - INTERVAL '1' YEAR AS neg_boundary;
neg_boundary
-834-03
SELECT -INTERVAL '0.999999' SECOND - INTERVAL '0.000001' SECOND AS neg_frac_overflow;
neg_frac_overflow
-1
SELECT INTERVAL '2' DAY + -INTERVAL '48' HOUR AS mixed_sign;
mixed_sign
0 00
SELECT -INTERVAL '1-1' YEAR TO MONTH - INTERVAL '6' MONTH AS neg_ym_carry;
neg_ym_carry
-1-07
SELECT INTERVAL '59.999999' SECOND + INTERVAL '0.000001' SECOND AS max_frac;
max_frac
60
SELECT INTERVAL '0.000001' SECOND + INTERVAL '0.000001' SECOND AS min_frac;
min_frac
0.2
SELECT INTERVAL '9999' YEAR + INTERVAL '1' MONTH AS max_yr_plus;
max_yr_plus
9999-01
SELECT INTERVAL '365' DAY + INTERVAL '8760:00' HOUR TO MINUTE AS year_approx;
year_approx
730 00:00
SELECT INTERVAL '0.0000004' SECOND + INTERVAL '0.0000005' SECOND AS micro_round;
micro_round
0
SELECT INTERVAL '0' DAY + INTERVAL '0' SECOND AS zero_add;
zero_add
0 00:00:00
SELECT INTERVAL '1-00' YEAR TO MONTH - INTERVAL '1' MONTH AS month_boundary;
month_boundary
0-11
SELECT INTERVAL '2' HOUR * 3 AS mul_int;
mul_int
6
SELECT 1.5 * INTERVAL '4' MINUTE AS mul_decimal;
mul_decimal
6
SELECT INTERVAL '1' DAY / 2 AS div_int;
div_int
0
SELECT INTERVAL '60' MINUTE / 1.5 AS div_decimal;
div_decimal
40
SELECT 3 * INTERVAL '2' YEAR AS comm_mul;
comm_mul
6
SELECT INTERVAL '1 02:30' DAY TO MINUTE * 2 AS comp_mul;
comp_mul
2 05:00
SELECT INTERVAL '2-6' YEAR TO MONTH / 2 AS comp_div;
comp_div
1-03
SELECT INTERVAL '1 12:00' DAY TO HOUR * 0.5 AS half_day;
half_day
0 18
SELECT INTERVAL '0.500' SECOND * 2 AS frac_preserve;
frac_preserve
1
SELECT INTERVAL '11' MONTH / 2 AS month_div;
month_div
6
SELECT -INTERVAL '2' HOUR * 3 AS neg_mul;
neg_mul
-6
SELECT INTERVAL '3' DAY * -1 AS neg_factor;
neg_factor
-3
SELECT INTERVAL '-60' MINUTE / -2 AS neg_div;
neg_div
30
SELECT -INTERVAL '1-6' YEAR TO MONTH * 1.5 AS comp_neg_mul;
comp_neg_mul
-2-03
SELECT -INTERVAL '2' DAY * -3 AS dbl_neg;
dbl_neg
6
SELECT INTERVAL '2' HOUR * 3 + INTERVAL '30' MINUTE AS mul_add;
mul_add
6:30
SELECT (INTERVAL '1' DAY - INTERVAL '12' HOUR) / 2 AS expr_div;
expr_div
0 06
SELECT 2 * (INTERVAL '1' YEAR + INTERVAL '6' MONTH) AS nested_mul;
nested_mul
3-00
SELECT INTERVAL '2:30' HOUR TO MINUTE * 2 - INTERVAL '10' MINUTE AS mixed_ops;
mixed_ops
4:50
SELECT (INTERVAL '1' DAY / 4) * 3 + INTERVAL '6' HOUR AS chain;
chain
0 06
SELECT INTERVAL '1' SECOND / 0 AS div_zero;
div_zero
0-00-0 00:00:00
SELECT INTERVAL '9999' YEAR * 0 AS zero_mul;
zero_mul
0
SELECT INTERVAL '0.999999' SECOND * 2 AS frac_overflow;
frac_overflow
1.999998
SELECT INTERVAL '9999' MONTH * 2 AS max_prec_mul;
max_prec_mul
6
SELECT INTERVAL '0.000001' SECOND / 2 AS micro_div;
micro_div
0.1
SELECT INTERVAL '8' HOUR * 5 AS work_week;
work_week
40
SELECT INTERVAL '1' DAY / 4 AS quarter_day;
quarter_day
0
SELECT DATE '2023-01-01' + (INTERVAL '1' DAY * 7) AS next_week;
next_week
2023-01-08
SELECT INTERVAL '0.5' SECOND * 1000 AS batch_time;
batch_time
500
SELECT INTERVAL '1-6' YEAR TO MONTH * 2 AS loan_term;
loan_term
3-00
SELECT INTERVAL '1:30' HOUR TO MINUTE * 1.5 AS comp_result;
comp_result
2:15
SELECT INTERVAL '3 18:00' DAY TO HOUR / 3 AS comp_div;
comp_div
1 06
SELECT -INTERVAL '2' DAY * 3 + INTERVAL '12' HOUR AS neg_combine;
neg_combine
-5 12
SELECT INTERVAL '1' MONTH * 0.5 AS frac_month;
frac_month
1
SELECT INTERVAL '1' DAY * 2 + INTERVAL '12' HOUR - INTERVAL '30' MINUTE AS mixed_types;
mixed_types
2 11:30
SELECT INTERVAL '1-0' YEAR TO MONTH = INTERVAL '12' MONTH;
INTERVAL '1-0' YEAR TO MONTH = INTERVAL '12' MONTH
1
SELECT INTERVAL '1 02:30:15' DAY TO SECOND = INTERVAL '26:30:15' HOUR TO SECOND;
INTERVAL '1 02:30:15' DAY TO SECOND = INTERVAL '26:30:15' HOUR TO SECOND
1
SELECT INTERVAL '6' MONTH <> INTERVAL '5' MONTH;
INTERVAL '6' MONTH <> INTERVAL '5' MONTH
1
SELECT INTERVAL '100' YEAR(3) > INTERVAL '99' YEAR(3);
INTERVAL '100' YEAR(3) > INTERVAL '99' YEAR(3)
1
SELECT INTERVAL '00:00:00.000001' SECOND(6) < INTERVAL '1' MINUTE;
INTERVAL '00:00:00.000001' SECOND(6) < INTERVAL '1' MINUTE
1
SELECT INTERVAL '2-6' YEAR TO MONTH = INTERVAL '30' MONTH;
INTERVAL '2-6' YEAR TO MONTH = INTERVAL '30' MONTH
1
SELECT INTERVAL '1 12:00:00' DAY TO SECOND = INTERVAL '36:00:00' HOUR TO SECOND;
INTERVAL '1 12:00:00' DAY TO SECOND = INTERVAL '36:00:00' HOUR TO SECOND
1
SELECT INTERVAL '-1' DAY > INTERVAL '-2' DAY;
INTERVAL '-1' DAY > INTERVAL '-2' DAY
1
SELECT INTERVAL '59.999999' SECOND(6) = INTERVAL '59.999999' SECOND(5);
INTERVAL '59.999999' SECOND(6) = INTERVAL '59.999999' SECOND(5)
0
SELECT INTERVAL '0' SECOND = INTERVAL '0' MINUTE;
INTERVAL '0' SECOND = INTERVAL '0' MINUTE
1
SELECT INTERVAL '9999-11' YEAR TO MONTH < INTERVAL '120000' MONTH;
INTERVAL '9999-11' YEAR TO MONTH < INTERVAL '120000' MONTH
1
SELECT INTERVAL '01.000001' SECOND(6) > INTERVAL '1' SECOND;
INTERVAL '01.000001' SECOND(6) > INTERVAL '1' SECOND
1
SELECT INTERVAL '5 04:30:00' DAY TO SECOND > INTERVAL '124:29:59' HOUR TO SECOND;
INTERVAL '5 04:30:00' DAY TO SECOND > INTERVAL '124:29:59' HOUR TO SECOND
1
SELECT INTERVAL '1000' MONTH(4) < INTERVAL '1000' MONTH(5);
INTERVAL '1000' MONTH(4) < INTERVAL '1000' MONTH(5)
0
SELECT INTERVAL '9999' DAY(7) > INTERVAL '239976' HOUR(8);
INTERVAL '9999' DAY(7) > INTERVAL '239976' HOUR(8)
0
SELECT INTERVAL '-1' YEAR < INTERVAL '0' MONTH;
INTERVAL '-1' YEAR < INTERVAL '0' MONTH
1
SELECT INTERVAL '59.999999' SECOND(6) = INTERVAL '59.999999' SECOND(6);
INTERVAL '59.999999' SECOND(6) = INTERVAL '59.999999' SECOND(6)
1
SELECT INTERVAL '3' YEAR > INTERVAL '35' MONTH;
INTERVAL '3' YEAR > INTERVAL '35' MONTH
1
SELECT INTERVAL '90' MINUTE = INTERVAL '1:30' HOUR TO MINUTE;
INTERVAL '90' MINUTE = INTERVAL '1:30' HOUR TO MINUTE
1
SELECT INTERVAL '1' DAY < NULL IS NULL;
INTERVAL '1' DAY < NULL IS NULL
1
SELECT INTERVAL '86400.000000' SECOND(6) = INTERVAL '1' DAY;
INTERVAL '86400.000000' SECOND(6) = INTERVAL '1' DAY
1
SELECT INTERVAL '0.000002' SECOND(6) <> INTERVAL '0.000001' SECOND(6);
INTERVAL '0.000002' SECOND(6) <> INTERVAL '0.000001' SECOND(6)
1
SELECT INTERVAL '12' MONTH <= INTERVAL '1' YEAR;
INTERVAL '12' MONTH <= INTERVAL '1' YEAR
1
SELECT INTERVAL '12' MONTH < INTERVAL '31104000.000001' SECOND(6);
INTERVAL '12' MONTH < INTERVAL '31104000.000001' SECOND(6)
1
SELECT INTERVAL '9999999' DAY(7) > INTERVAL '9999998' DAY(7);
INTERVAL '9999999' DAY(7) > INTERVAL '9999998' DAY(7)
1
SELECT INTERVAL '100000' MONTH(12) > INTERVAL '99999' MONTH(12);
INTERVAL '100000' MONTH(12) > INTERVAL '99999' MONTH(12)
1
SELECT INTERVAL '-0.000001' SECOND(6) = INTERVAL '-0.000001' SECOND(6);
INTERVAL '-0.000001' SECOND(6) = INTERVAL '-0.000001' SECOND(6)
1
SELECT INTERVAL '1 02:30:45.678' DAY TO SECOND > INTERVAL '26:30:45.677' HOUR TO SECOND;
INTERVAL '1 02:30:45.678' DAY TO SECOND > INTERVAL '26:30:45.677' HOUR TO SECOND
1
SELECT INTERVAL '0.000002' SECOND(6) - INTERVAL '0.000001' SECOND(6);
INTERVAL '0.000002' SECOND(6) - INTERVAL '0.000001' SECOND(6)
0.1
CREATE PROCEDURE project_timeline_calculator()
BEGIN
DECLARE project_start TIMESTAMP;
DECLARE task1_duration, task2_duration, task3_duration INTERVAL DAY TO SECOND;
DECLARE task1_end, task2_end, task3_end TIMESTAMP;
DECLARE total_planned, actual_duration, difference INTERVAL DAY TO SECOND;
SET project_start = '2025-01-01 12:00:00';
SET task1_duration = INTERVAL '2 12:30:00' DAY TO SECOND;
SET task2_duration = INTERVAL '1 18:45:15.500' DAY TO SECOND * 1.5;
SET task3_duration = INTERVAL '3 06:15:30' DAY TO SECOND;
SET task1_end = project_start + task1_duration;
SET task2_end = task1_end + task2_duration;
SET task3_end = task2_end + task3_duration;
SET total_planned = task1_duration + task2_duration;
SET actual_duration = task3_duration;
SET difference = total_planned - actual_duration;
SELECT
project_start AS start_time,
task1_end AS task1_completion,
task2_end AS task2_completion,
task3_end AS task3_completion,
task1_duration AS task1_length,
task2_duration AS task2_length,
task3_duration AS task3_length,
total_planned AS task1_plus_task2,
difference AS planned_minus_actual;
END /
call project_timeline_calculator();
start_time	task1_completion	task2_completion	task3_completion	task1_length	task2_length	task3_length	task1_plus_task2	planned_minus_actual
2025-01-01 12:00:00	2025-01-04 00:30:00	2025-01-06 16:37:53	2025-01-09 22:53:23	2 12:30:00	2 16:07:53.250000	3 06:15:30	5 04:37:53.250000	1 22:22:23.250000
drop procedure project_timeline_calculator;
CREATE PROCEDURE interval_operations()
BEGIN
DECLARE base_datetime TIMESTAMP;
DECLARE interval1 INTERVAL DAY TO MINUTE;
DECLARE interval2 INTERVAL HOUR TO MINUTE;
DECLARE interval_sum, interval_diff, interval_multiplied INTERVAL DAY TO MINUTE;
DECLARE result_datetime TIMESTAMP;
SET base_datetime = '2025-01-01 12:00:00';
SET interval1 = INTERVAL '2 06:00' DAY TO MINUTE;
SET interval2 = INTERVAL '30:00' HOUR TO MINUTE;
SET interval_sum = interval1 + interval2;
SET interval_diff = interval1 - interval2;
SET interval_multiplied = interval_diff * 10;
SET result_datetime = base_datetime + interval_multiplied;
SELECT
base_datetime AS base_time,
interval1 AS first_interval,
interval2 AS second_interval,
interval_sum AS sum_of_intervals,
interval_diff AS difference_of_intervals,
interval_multiplied AS difference_times_10,
result_datetime AS final_datetime;
END /
CALL interval_operations();
base_time	first_interval	second_interval	sum_of_intervals	difference_of_intervals	difference_times_10	final_datetime
2025-01-01 12:00:00	2 06:00	30:00	3 12:00	1 00:00	10 00:00	2025-01-11 12:00:00
DROP PROCEDURE interval_operations;
CREATE PROCEDURE test_interval_arithmetic(
IN iv1 INTERVAL DAY TO SECOND,
IN iv2 INTERVAL DAY TO SECOND,
IN num DOUBLE,
OUT add_result INTERVAL DAY TO SECOND,
OUT sub_result INTERVAL DAY TO SECOND,
OUT mul_result INTERVAL DAY TO SECOND,
OUT div_result INTERVAL DAY TO SECOND
)
BEGIN
SET add_result = iv1 + iv2;
SET sub_result = iv1 - iv2;
SET mul_result = iv1 * num;
SET div_result = iv1 * num;
END /
SET @result1 = NULL, @result2 = NULL, @result3 = NULL, @result4 = NULL;
CALL test_interval_arithmetic(
INTERVAL '1 12:30:45' DAY TO SECOND,
INTERVAL '2 06:15:30' DAY TO SECOND,
1.5,
@result1, @result2, @result3, @result4
);
SELECT @result1, @result2, @result3, @result4;
@result1	@result2	@result3	@result4
3 18:46:15	-0 17:44:45	2 06:46:07.500000	2 06:46:07.500000
DROP PROCEDURE test_interval_arithmetic;
CREATE PROCEDURE test_interval_comparisons(
IN ym1 INTERVAL YEAR TO MONTH,
IN ym2 INTERVAL YEAR TO MONTH,
IN dt1 INTERVAL DAY TO SECOND,
IN dt2 INTERVAL DAY TO SECOND,
OUT ym_eq BOOLEAN,
OUT ym_gt BOOLEAN,
OUT dt_eq BOOLEAN,
OUT dt_lt BOOLEAN
)
BEGIN
SET ym_eq = ym1 = ym2;
SET ym_gt = ym1 > ym2;
SET dt_eq = dt1 = dt2;
SET dt_lt = dt1 < dt2;
END /
SET @ym_eq = NULL, @ym_gt = NULL, @dt_eq = NULL, @dt_lt = NULL;
CALL test_interval_comparisons(
INTERVAL '2-6' YEAR TO MONTH,
INTERVAL '30' MONTH,
INTERVAL '1 12:00:00' DAY TO SECOND,
INTERVAL '36:00:00' HOUR TO SECOND,
@ym_eq, @ym_gt, @dt_eq, @dt_lt
);
SELECT @ym_eq, @ym_gt, @dt_eq, @dt_lt;
@ym_eq	@ym_gt	@dt_eq	@dt_lt
1	0	1	0
DROP PROCEDURE test_interval_comparisons;
CREATE PROCEDURE test_interval_complex(
INOUT io_interval INTERVAL DAY TO SECOND,
IN add_iv INTERVAL HOUR TO MINUTE,
IN mul_factor DOUBLE
)
BEGIN
SET io_interval = io_interval + add_iv;
SET io_interval = io_interval * mul_factor;
SET io_interval = io_interval + INTERVAL '1 06:30:45' DAY TO SECOND;
END /
SET @complex_iv = INTERVAL '2 12:30:45' DAY TO SECOND;
CALL test_interval_complex(
@complex_iv,
INTERVAL '4:45' HOUR TO MINUTE,
0.5
);
SELECT @complex_iv;
@complex_iv
2 15:08:37.500000
DROP PROCEDURE test_interval_complex;
CREATE PROCEDURE test_ym_interval(
INOUT io_ym INTERVAL YEAR TO MONTH,
IN add_ym INTERVAL YEAR TO MONTH,
OUT final_result INTERVAL YEAR TO MONTH,
OUT is_positive BOOLEAN
)
BEGIN
SET io_ym = io_ym + add_ym;
SET final_result = io_ym / 2 - INTERVAL '6' MONTH;
SET is_positive = final_result > INTERVAL '0' YEAR;
END |
SET @ym_io = INTERVAL '1-6' YEAR TO MONTH;
SET @ym_final = NULL;
SET @ym_positive = NULL;
CALL test_ym_interval(
@ym_io,
INTERVAL '2' YEAR,
@ym_final,
@ym_positive
);
SELECT @ym_io, @ym_final, @ym_positive;
@ym_io	@ym_final	@ym_positive
3-06	1-03	1
DROP PROCEDURE test_ym_interval;
CREATE PROCEDURE compare_intervals(
IN interval1 INTERVAL DAY TO SECOND,
IN interval2 INTERVAL DAY TO SECOND,
OUT max_interval INTERVAL DAY TO SECOND
)
BEGIN
CASE
WHEN interval1 > interval2 THEN
SET max_interval = interval1;
WHEN interval2 > interval1 THEN
SET max_interval = interval2;
ELSE
SET max_interval = interval1;
END CASE;
END /
set @max1 =NULL;
CALL compare_intervals(
INTERVAL '2 12:30:45' DAY TO SECOND,
INTERVAL '1 06:15:30' DAY TO SECOND,
@max1
);
SELECT @max1;
@max1
2 12:30:45
DROP PROCEDURE compare_intervals;
SELECT NULLIF(INTERVAL '2 12:30:45' DAY TO SECOND, INTERVAL '2 12:30:46' DAY TO SECOND);
NULLIF(INTERVAL '2 12:30:45' DAY TO SECOND, INTERVAL '2 12:30:46' DAY TO SECOND)
2 12:30:45
SELECT
NULLIF(INTERVAL '2 12:30:45' DAY TO SECOND, INTERVAL '2 12:30:45' DAY TO SECOND) AS nullif_equal,
NULLIF(INTERVAL '1' DAY, INTERVAL '2' DAY) AS nullif_different,
NULLIF(INTERVAL '0' SECOND, INTERVAL '0' MINUTE) AS nullif_zero_equivalents;
nullif_equal	nullif_different	nullif_zero_equivalents
NULL	1	NULL
SELECT
IFNULL(NULL, INTERVAL '5' HOUR) AS ifnull_with_null,
IFNULL(INTERVAL '2 12:30:45' DAY TO SECOND, INTERVAL '1' DAY) AS ifnull_with_value,
IFNULL(INTERVAL '0' SECOND, INTERVAL '1' HOUR) AS ifnull_with_zero;
ifnull_with_null	ifnull_with_value	ifnull_with_zero
5	2 12:30:45	0
SELECT
COALESCE(NULL, NULL, INTERVAL '3' DAY, INTERVAL '2' HOUR) AS coalesce_first_non_null,
COALESCE(INTERVAL '1 12:30:45' DAY TO SECOND, INTERVAL '1' DAY) AS coalesce_first_value,
COALESCE(NULL, INTERVAL '0' SECOND, INTERVAL '5' MINUTE) AS coalesce_second_value;
coalesce_first_non_null	coalesce_first_value	coalesce_second_value
3	1 12:30:45	0
SELECT
IF(1 = 1, INTERVAL '2 12:30:45' DAY TO SECOND, INTERVAL '1' DAY) AS if_true,
IF(1 = 0, INTERVAL '2 12:30:45' DAY TO SECOND, INTERVAL '1' DAY) AS if_false;
if_true	if_false
2 12:30:45	1
SELECT
NVL2(NULL, INTERVAL '5' HOUR, INTERVAL '2' DAY) AS nvl_null,
NVL2(INTERVAL '1 12:30:45' DAY TO SECOND, INTERVAL '3' HOUR, INTERVAL '2' DAY) AS nvl_value;
nvl_null	nvl_value
2	3
SELECT
NVL(NULL, INTERVAL '5' HOUR) AS nvl_null_result,
NVL(INTERVAL '1 12:30:45' DAY TO SECOND, INTERVAL '3' HOUR) AS nvl_value_result;
nvl_null_result	nvl_value_result
5	1 12:30:45
SELECT
IF(INTERVAL '2' DAY > INTERVAL '48' HOUR,
INTERVAL '1' DAY,
INTERVAL '12' HOUR) AS comparison_result;
comparison_result
12
SELECT FLOOR(INTERVAL '1 12:30:45.123456' DAY TO SECOND) AS result;
result
1 12:30:45
SELECT CEIL(INTERVAL '1 12:30:45.123456' DAY TO SECOND) AS result;
result
1 12:30:46
SELECT
ROUND(INTERVAL '1 12:30:45.567899' DAY TO SECOND, 0) AS round_0,
ROUND(INTERVAL '1 12:30:45.567899' DAY TO SECOND, 3) AS round_3,
ROUND(INTERVAL '1 12:30:45.567899' DAY TO SECOND, 6) AS round_6;
round_0	round_3	round_6
1 12:30:46	1 12:30:45.568000	1 12:30:45.567899
SELECT
FLOOR(INTERVAL '36:30:45.123456' HOUR TO SECOND) AS hour_floored;
hour_floored
36:30:45
SELECT
CEIL(INTERVAL '36:30:45.123456' HOUR TO SECOND) AS hour_ceiled;
hour_ceiled
36:30:46
SELECT ROUND(INTERVAL '1 12:30:45.500000' DAY TO SECOND, 0) AS rounded;
rounded
1 12:30:46
SELECT FLOOR(INTERVAL '1 12:30:45.000000' DAY TO SECOND) AS floored;
floored
1 12:30:45
SELECT CEIL(INTERVAL '1 12:30:45.000000' DAY TO SECOND) AS ceiled;
ceiled
1 12:30:45
SELECT COALESCE(
FLOOR(INTERVAL '1 12:30:45.123456' DAY TO SECOND),
INTERVAL '0' SECOND
) AS result;
result
1 12:30:45
SELECT
IF(INTERVAL '2' DAY > INTERVAL '48' HOUR,
ROUND(INTERVAL '1 12:30:45.567899' DAY TO SECOND, 2),
ROUND(INTERVAL '12:30:45.567899' HOUR TO SECOND, 2)
) AS result;
result
12:30:45.570000
SELECT LEAST(
INTERVAL '12:30:45' HOUR TO SECOND,
INTERVAL '10:45:30' HOUR TO SECOND,
INTERVAL '14:15:20' HOUR TO SECOND
) AS least_time;
least_time
10:45:30
SELECT GREATEST(
INTERVAL '1 12:30:45' DAY TO SECOND,
INTERVAL '1 10:45:30' DAY TO SECOND
) AS greatest_full_interval;
greatest_full_interval
1 12:30:45
SELECT GREATEST(
COALESCE(NULL, INTERVAL '5' HOUR),
COALESCE(INTERVAL '3' HOUR, INTERVAL '2' DAY)
) AS coalesce_greatest;
coalesce_greatest
5
SELECT
CASE
WHEN GREATEST(INTERVAL '2' DAY, INTERVAL '48' HOUR) = INTERVAL '2' DAY
THEN INTERVAL '1' DAY
ELSE INTERVAL '12' HOUR
END AS case_result;
case_result
1
SELECT LEAST(
INTERVAL '1 12:30:45.123' DAY TO SECOND(3),
INTERVAL '1 12:30:45.124' DAY TO SECOND(3)
) AS least_precise;
least_precise
1 12:30:45.123000
SELECT GREATEST(
INTERVAL '2' DAY,
INTERVAL '36' HOUR,
INTERVAL '180' MINUTE,
INTERVAL '10000' SECOND
) AS complex_greatest;
complex_greatest
2
SELECT
CASE
WHEN GREATEST(INTERVAL '2' DAY, INTERVAL '48' HOUR) = INTERVAL '2' DAY
THEN INTERVAL '1' DAY
ELSE INTERVAL '12' HOUR
END AS case_result;
case_result
1

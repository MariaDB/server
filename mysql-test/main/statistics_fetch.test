--echo #
--echo # Test to inspect the range_selectivity returned by Histogram_json and Histogram_binary
--echo # todo: should be merged with statistics_json.test
--echo #

create table ten(a int primary key);
insert into ten values (0),(1),(2),(3),(4),(5),(6),(7),(8),(9);

create table t1 (a varchar(255));
insert into t1 select concat('a-', a) from ten;

analyze table t1 persistent for all;
select * from mysql.column_stats where table_name='t1';
explain extended select * from t1 where a between 'a-3a' and 'zzzzzzzzz';

create table t2(a int);
insert into t2 select a*10 from ten;
analyze table t2 persistent for all;
explain extended select * from t2 where a between '44' and '55';

drop table t1;
drop table t2;

create table t1 (a varchar(255));
insert into t1 select concat('a-', a) from ten;
set histogram_type=json;

analyze table t1 persistent for all;
select * from mysql.column_stats where table_name='t1';
explain extended select * from t1 where a between 'a-3a' and 'zzzzzzzzz';

create table t2(a int);
insert into t2 select a*10 from ten;
set histogram_type=json;
analyze table t2 persistent for all;
explain extended select * from t2 where a between '44' and '55';

drop table t1;
drop table t2;


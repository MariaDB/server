CREATE TABLE t1 (
id INTEGER,
age INTEGER,
weight INTEGER
);
INSERT INTO t1 (id, age, weight) VALUES (1, 1, 1), (1, 2, 1), (1, 3, 1), (1, 4, 4);
INSERT INTO t1 (id, age, weight) VALUES (2, 1, 1), (2, 2, 1), (2, 3, 1), (2, 4, 4);
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight)
FROM t1;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight),
REGR_R2(age, weight)
FROM t1 GROUP BY id;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)	REGR_R2(age, weight)
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
INSERT INTO t1 (id, age, weight) VALUES (1, 1, NULL);
INSERT INTO t1 (id, age, weight) VALUES (1, NULL, NULL);
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight)
FROM t1;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight),
REGR_R2(age, weight)
FROM t1 GROUP BY id;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)	REGR_R2(age, weight)
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
DROP TABLE t1;
CREATE TABLE t1 (
id INTEGER,
age INTEGER,
weight INTEGER
);
INSERT INTO t1 (id, age, weight) VALUES (1, 1, 1), (1, 1, 1), (1, 1, 1), (1, 1, 1);
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight)
FROM t1;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)
4	1.0000	1.0000	0.0000	0.0000	0.0000	NULL	NULL
DROP TABLE t1;
CREATE TABLE t1 (
id INTEGER,
age INTEGER,
weight FLOAT
);
INSERT INTO t1 (id, age, weight) VALUES (1, 1, 1), (1, 2, 1), (1, 3, 1), (1, 4, 4);
INSERT INTO t1 (id, age, weight) VALUES (2, 1, 1), (2, 2, 1), (2, 3, 1), (2, 4, 4);
SELECT
REGR_COUNT(age, weight) OVER(),
REGR_AVGX(age, weight)  OVER(),
REGR_AVGY(age, weight)  OVER(),
REGR_SXX(age, weight)  OVER(),
REGR_SYY(age, weight)  OVER(),
REGR_SXY(age, weight)  OVER(),
REGR_SLOPE(age, weight)  OVER(),
REGR_INTERCEPT(age, weight)  OVER()
FROM t1;
REGR_COUNT(age, weight) OVER()	REGR_AVGX(age, weight)  OVER()	REGR_AVGY(age, weight)  OVER()	REGR_SXX(age, weight)  OVER()	REGR_SYY(age, weight)  OVER()	REGR_SXY(age, weight)  OVER()	REGR_SLOPE(age, weight)  OVER()	REGR_INTERCEPT(age, weight)  OVER()
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
SELECT
id,
REGR_COUNT(age, weight) OVER(PARTITION BY id),
REGR_AVGX(age, weight) OVER(PARTITION BY id),
REGR_AVGY(age, weight) OVER(PARTITION BY id),
REGR_SYY(age, weight) OVER(PARTITION BY id),
REGR_SXY(age, weight) OVER(PARTITION BY id),
REGR_SLOPE(age, weight) OVER(PARTITION BY id),
REGR_INTERCEPT(age, weight) OVER(PARTITION BY id)
FROM t1;
id	REGR_COUNT(age, weight) OVER(PARTITION BY id)	REGR_AVGX(age, weight) OVER(PARTITION BY id)	REGR_AVGY(age, weight) OVER(PARTITION BY id)	REGR_SYY(age, weight) OVER(PARTITION BY id)	REGR_SXY(age, weight) OVER(PARTITION BY id)	REGR_SLOPE(age, weight) OVER(PARTITION BY id)	REGR_INTERCEPT(age, weight) OVER(PARTITION BY id)
1	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333
1	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333
1	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333
1	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333
2	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333
2	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333
2	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333
2	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333
DROP TABLE t1;

CREATE TABLE t1 (
id INTEGER,
age INTEGER,
weight INTEGER
);
INSERT INTO t1 (id, age, weight) VALUES (1, 1, 1), (1, 2, 1), (1, 3, 1), (1, 4, 4);
INSERT INTO t1 (id, age, weight) VALUES (2, 1, 1), (2, 2, 1), (2, 3, 1), (2, 4, 4);
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight)
FROM t1;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight),
REGR_R2(age, weight)
FROM t1 GROUP BY id;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)	REGR_R2(age, weight)
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
INSERT INTO t1 (id, age, weight) VALUES (1, 1, NULL);
INSERT INTO t1 (id, age, weight) VALUES (1, NULL, NULL);
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight),
REGR_R2(age, weight)
FROM t1;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)	REGR_R2(age, weight)
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight),
REGR_R2(age, weight)
FROM t1 GROUP BY id;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)	REGR_R2(age, weight)
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
DROP TABLE t1;
CREATE TABLE t1 (
id INTEGER,
age INTEGER,
weight INTEGER
);
INSERT INTO t1 (id, age, weight) VALUES (1, 1, 1), (1, 1, 1), (1, 1, 1), (1, 1, 1);
SELECT
REGR_COUNT(age, weight),
REGR_AVGX(age, weight),
REGR_AVGY(age, weight),
REGR_SXX(age, weight),
REGR_SYY(age, weight),
REGR_SXY(age, weight),
REGR_SLOPE(age, weight),
REGR_INTERCEPT(age, weight),
REGR_R2(age, weight)
FROM t1;
REGR_COUNT(age, weight)	REGR_AVGX(age, weight)	REGR_AVGY(age, weight)	REGR_SXX(age, weight)	REGR_SYY(age, weight)	REGR_SXY(age, weight)	REGR_SLOPE(age, weight)	REGR_INTERCEPT(age, weight)	REGR_R2(age, weight)
4	1.0000	1.0000	0.0000	0.0000	0.0000	NULL	NULL	NULL
DROP TABLE t1;
CREATE TABLE t1 (
id INTEGER,
age INTEGER,
weight FLOAT
);
INSERT INTO t1 (id, age, weight) VALUES (1, 1, 1), (1, 2, 1), (1, 3, 1), (1, 4, 4);
INSERT INTO t1 (id, age, weight) VALUES (2, 1, 1), (2, 2, 1), (2, 3, 1), (2, 4, 4);
SELECT
REGR_COUNT(age, weight) OVER(),
REGR_AVGX(age, weight)  OVER(),
REGR_AVGY(age, weight)  OVER(),
REGR_SXX(age, weight)  OVER(),
REGR_SYY(age, weight)  OVER(),
REGR_SXY(age, weight)  OVER(),
REGR_SLOPE(age, weight)  OVER(),
REGR_INTERCEPT(age, weight)  OVER(),
REGR_R2(age, weight)  OVER()
FROM t1;
REGR_COUNT(age, weight) OVER()	REGR_AVGX(age, weight)  OVER()	REGR_AVGY(age, weight)  OVER()	REGR_SXX(age, weight)  OVER()	REGR_SYY(age, weight)  OVER()	REGR_SXY(age, weight)  OVER()	REGR_SLOPE(age, weight)  OVER()	REGR_INTERCEPT(age, weight)  OVER()	REGR_R2(age, weight)  OVER()
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
8	1.7500	2.5000	13.5000	10.0000	9.0000	0.6667	1.3333	0.6000
SELECT
id,
REGR_COUNT(age, weight) OVER(PARTITION BY id),
REGR_AVGX(age, weight) OVER(PARTITION BY id),
REGR_AVGY(age, weight) OVER(PARTITION BY id),
REGR_SYY(age, weight) OVER(PARTITION BY id),
REGR_SXY(age, weight) OVER(PARTITION BY id),
REGR_SLOPE(age, weight) OVER(PARTITION BY id),
REGR_INTERCEPT(age, weight) OVER(PARTITION BY id),
REGR_R2(age, weight) OVER(PARTITION BY id)
FROM t1;
id	REGR_COUNT(age, weight) OVER(PARTITION BY id)	REGR_AVGX(age, weight) OVER(PARTITION BY id)	REGR_AVGY(age, weight) OVER(PARTITION BY id)	REGR_SYY(age, weight) OVER(PARTITION BY id)	REGR_SXY(age, weight) OVER(PARTITION BY id)	REGR_SLOPE(age, weight) OVER(PARTITION BY id)	REGR_INTERCEPT(age, weight) OVER(PARTITION BY id)	REGR_R2(age, weight) OVER(PARTITION BY id)
1	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333	0.6000
1	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333	0.6000
1	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333	0.6000
1	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333	0.6000
2	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333	0.6000
2	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333	0.6000
2	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333	0.6000
2	4	1.7500	2.5000	5.0000	4.5000	0.6667	1.3333	0.6000
DROP TABLE t1;
CREATE TABLE t1 (
id INTEGER,
age INTEGER,
weight INTEGER
);
INSERT INTO t1 (id, age, weight) VALUES (1, 1, 1), (2, 2, 1), (3, 3, 1), (4, 4, 4);
INSERT INTO t1 (id, age, weight) VALUES (5, 5, 1), (6, 6, 1), (7, 7, 1), (8, 8, 4);
SELECT
REGR_COUNT(age, weight) OVER(ORDER BY id rows between 2 preceding and 2 following),
REGR_AVGX(age, weight) OVER(ORDER BY id rows between 2 preceding and 2 following),
REGR_AVGY(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following),
REGR_SXX(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following),
REGR_SYY(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following),
REGR_SXY(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following),
REGR_SLOPE(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following),
REGR_INTERCEPT(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following),
REGR_R2(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following)
FROM t1;
REGR_COUNT(age, weight) OVER(ORDER BY id rows between 2 preceding and 2 following)	REGR_AVGX(age, weight) OVER(ORDER BY id rows between 2 preceding and 2 following)	REGR_AVGY(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following)	REGR_SXX(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following)	REGR_SYY(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following)	REGR_SXY(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following)	REGR_SLOPE(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following)	REGR_INTERCEPT(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following)	REGR_R2(age, weight)  OVER(ORDER BY id rows between 2 preceding and 2 following)
3	1.0000	2.0000	0.0000	2.0000	0.0000	NULL	NULL	NULL
4	1.7500	2.5000	6.7500	5.0000	4.5000	0.6667	1.3333	0.6000
5	1.6000	3.0000	7.2000	10.0000	3.0000	0.4167	2.3333	0.1250
5	1.6000	4.0000	7.2000	10.0000	0.0000	0.0000	4.0000	0.0000
5	1.6000	5.0000	7.2000	10.0000	-3.0000	-0.4167	5.6667	0.1250
5	2.2000	6.0000	10.8000	10.0000	0.0000	0.0000	6.0000	0.0000
4	1.7500	6.5000	6.7500	5.0000	4.5000	0.6667	5.3333	0.6000
3	2.0000	7.0000	6.0000	2.0000	3.0000	0.5000	6.0000	0.7500

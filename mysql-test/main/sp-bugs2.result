CREATE TABLE t1 (i INT);
SET @a = 2;
CREATE TABLE IF NOT EXISTS t2 (i INT) ENGINE = MyISAM 
AS SELECT * FROM t1;
CREATE TABLE IF NOT EXISTS t2 (i INT) ENGINE = MyISAM 
AS SELECT * FROM t1;
Warnings:
Note	1050	Table 't2' already exists
DROP TABLE t2;
CREATE PROCEDURE sp()
BEGIN
REPEAT 
CREATE TABLE IF NOT EXISTS t2 (i INT) ENGINE = MyISAM 
AS SELECT * FROM t1; 
SET @a = @a - 1; 
UNTIL @a = 0 
END REPEAT ;
END |
CALL sp();
Warnings:
Note	1050	Table 't2' already exists
DROP PROCEDURE sp;
DROP TABLE t1, t2;
#
# MDEV-26115: Crash when calling stored function in FOR loop argument
#
CREATE OR REPLACE FUNCTION cnt()
RETURNS INTEGER NO SQL
BEGIN
RETURN 3;
END;
$
CREATE OR REPLACE PROCEDURE p1()
NO SQL
BEGIN
DECLARE i INTEGER;
FOR i IN 1..cnt() DO
SELECT 1;
END FOR;
END;
$
CALL p1();
1
1
1
1
1
1
CALL p1();
1
1
1
1
1
1
# Clean up
DROP FUNCTION cnt;
DROP PROCEDURE p1;
# End of 10.6 tests

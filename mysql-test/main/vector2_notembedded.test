--echo #
--echo # MDEV-35044 ALTER on a table with vector index attempts to bypass unsupported locking limitation, server crashes in THD::free_tmp_table_share
--echo #
create table t (a int primary key, v vector(10) not null, vector index(v));
--error ER_ALTER_OPERATION_NOT_SUPPORTED_REASON
alter table t modify a int auto_increment, lock=none;
drop table t;

--echo #
--echo # MDEV-35223 REPAIR does not fix MyISAM table with vector key after crash recovery
--echo #
call mtr.add_suppression('t#i#00'' is marked as crashed and should be repaired');
create table t (v vector(1) not null, vector(v)) engine=myisam;
insert into t (v) values (0x30303030),(0x31313131);
--let $shutdown_timeout=0
--source include/restart_mysqld.inc
check table t extended;
repair table t extended;
check table t extended;
select v from t order by vec_distance_euclidean(0x323233232,v) limit 1;
drop table t;

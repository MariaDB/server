--source include/not_embedded.inc

create user foo;
create database some_db;
create database secret_db;
create table some_db.t1 (a int, b char);

#create procedure
#create function
#create package
#create package body

grant select,insert on *.* to foo;
deny select, update on *.* to foo;

grant select, delete on some_db.* to foo;
deny insert, update on some_db.* to foo;

#TODO(cvicentiu) Denying with grant option reads a bit strange.
#                perhaps a different syntax is warranted, such as
#                DENY ....   including grant option.
deny all on secret_db.* to foo with grant option;

#TODO(cvicentiu) Show denies where appropriate.
show grants for foo;

--connect (con1,localhost,foo,,)
show grants;
disconnect con1;

connection default;

create role bar;
show grants for bar;

--echo #
--echo # Test role show grants
--echo #
deny select on *.* to bar;
deny insert on one_db.* to bar;
deny update on one_db.t1 to bar;
deny update (c1) on one_db.t1 to bar;
deny insert (c1) on one_db.t1 to bar;
deny insert (c2) on one_db.t1 to bar;
deny insert (c3, c4) on one_db.t1 to bar;

deny all privileges on one_db.t2 to bar;
deny select (c_b, c_a) on one_db.t2 to bar;
deny usage on one_db.t2 to bar with grant option;

grant bar to foo;
--connect (con1, localhost, foo,,)
set role bar;
show grants;
disconnect con1;
connection default;

drop database some_db;
drop database secret_db;
drop user foo;
drop role bar;

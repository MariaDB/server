create role r1, r2;
create user foo;
create database some_db;
create table some_db.t1 (a int, b int, secret int);
create view some_db.v1 as (select a, b, secret from some_db.t1);
grant all on *.* to foo;
grant all on some_db.* to foo;
grant all on some_db.t1 to foo;
grant all on some_db.v1 to foo;
grant r2 to r1;
grant r1 to foo;
deny select on *.* to r2;
connect  con1, localhost, foo,,;
select * from some_db.t1;
a	b	secret
set role r1;
select * from some_db.t1;
ERROR 42000: SELECT command denied to user 'foo'@'localhost' for table 't1'
set role none;
select * from some_db.t1;
a	b	secret
show grants;
Grants for foo@%
GRANT `r1` TO `foo`@`%`
GRANT ALL PRIVILEGES ON *.* TO `foo`@`%`
GRANT ALL PRIVILEGES ON `some_db`.* TO `foo`@`%`
GRANT ALL PRIVILEGES ON `some_db`.`v1` TO `foo`@`%`
GRANT ALL PRIVILEGES ON `some_db`.`t1` TO `foo`@`%`
disconnect con1;
connection default;
drop role r1, r2;
drop user foo;
drop database some_db;

SET GLOBAL innodb_log_file_size=4194304;
SHOW VARIABLES LIKE 'innodb_log_file_size';
Variable_name	Value
innodb_log_file_size	4194304
SELECT global_value FROM information_schema.system_variables
WHERE variable_name = 'innodb_log_file_size';
global_value
4194304
CREATE TABLE t (
a INT PRIMARY KEY AUTO_INCREMENT,
b CHAR(255) NOT NULL)
ENGINE=INNODB;
INSERT INTO t SELECT NULL, REPEAT('a', 255) FROM seq_1_to_20000;
# restart: --innodb-log-file-size=4198400 --innodb-log-buffer-size=2m --innodb-log-write-ahead-size=4m
SELECT * FROM INFORMATION_SCHEMA.ENGINES
WHERE engine = 'innodb'
AND support IN ('YES', 'DEFAULT', 'ENABLED');
ENGINE	SUPPORT	COMMENT	TRANSACTIONS	XA	SAVEPOINTS
# restart: --innodb-log-file-size=4198400 --innodb-log-buffer-size=4m --innodb-log-write-ahead-size=4m
SELECT * FROM INFORMATION_SCHEMA.ENGINES
WHERE engine = 'innodb'
AND support IN ('YES', 'DEFAULT', 'ENABLED');
ENGINE	SUPPORT	COMMENT	TRANSACTIONS	XA	SAVEPOINTS
# restart: --innodb-log-file-size=4198400 --innodb-log-write-ahead-size=8193
SELECT * FROM INFORMATION_SCHEMA.ENGINES
WHERE engine = 'innodb'
AND support IN ('YES', 'DEFAULT', 'ENABLED');
ENGINE	SUPPORT	COMMENT	TRANSACTIONS	XA	SAVEPOINTS
# restart: --innodb-log-file-size=4198400 --innodb-log-write-ahead-size=8192
SELECT * FROM INFORMATION_SCHEMA.ENGINES
WHERE engine = 'innodb'
AND support IN ('YES', 'DEFAULT', 'ENABLED');
ENGINE	SUPPORT	COMMENT	TRANSACTIONS	XA	SAVEPOINTS
# restart: --innodb-log-file-size=4198400 --innodb-log-write-ahead-size=4096
SELECT COUNT(*) FROM t;
COUNT(*)
20000
SHOW VARIABLES LIKE 'innodb_log_file_size';
Variable_name	Value
innodb_log_file_size	4198400
NOT FOUND /InnoDB: InnoDB: innodb_log_write_ahead_size=\d+ is not/ in mysqld.1.err
FOUND 1 /InnoDB: Resized log to 4\.000MiB/ in mysqld.1.err
UPDATE t SET b='' WHERE a<10;
SET GLOBAL innodb_log_write_ahead_size=16384;
ERROR HY000: Incorrect arguments to innodb_log_write_ahead_size
SELECT @@GLOBAL.innodb_log_write_ahead_size;
@@GLOBAL.innodb_log_write_ahead_size
4096
SET GLOBAL innodb_log_file_size=5251072;
SET GLOBAL innodb_log_write_ahead_size=8192;
SELECT @@GLOBAL.innodb_log_write_ahead_size;
@@GLOBAL.innodb_log_write_ahead_size
8192
SHOW VARIABLES LIKE 'innodb_log_file_size';
Variable_name	Value
innodb_log_file_size	5251072
SELECT global_value FROM information_schema.system_variables
WHERE variable_name = 'innodb_log_file_size';
global_value
5251072
SET GLOBAL innodb_log_write_ahead_size=4096;
SET GLOBAL innodb_log_write_ahead_size=16384;
ERROR HY000: Incorrect arguments to innodb_log_write_ahead_size
SET GLOBAL innodb_log_write_ahead_size=8192;
SELECT @@GLOBAL.innodb_log_write_ahead_size;
@@GLOBAL.innodb_log_write_ahead_size
8192
# restart
SELECT * FROM t WHERE a<10;
a	b
1	
2	
3	
4	
5	
6	
7	
8	
9	
SHOW VARIABLES LIKE 'innodb_log_file_size';
Variable_name	Value
innodb_log_file_size	5242880
FOUND 1 /InnoDB: Resized log to 5\.008MiB/ in mysqld.1.err
DROP TABLE t;

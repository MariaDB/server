#
# Test different value of innodb_use_scn
#
create table t1(id int, c1 int) engine=innodb;
insert into t1 value(1,1);
insert into t1 value(2,1);
insert into t1 value(3,1);
update t1 set c1=2 where id=1;
update t1 set c1=2 where id=2;
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
SET GLOBAL innodb_fast_shutdown=0;
# restart: --innodb-use-scn=ON
show variables like '%use_scn%';
Variable_name	Value
innodb_use_scn	ON
insert into t1 values(4,1);
update t1 set c1=2 where id=3;
update t1 set c1=4 where id=3;
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
InnoDB		0 transactions not purged
# restart: --innodb-use-scn=OFF
show variables like '%use_scn%';
Variable_name	Value
innodb_use_scn	OFF
insert into t1 values(5,1);
update t1 set c1=2 where id=4;
check table t1 extended;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
InnoDB		0 transactions not purged
# restart: --innodb-use-scn=ON
show variables like '%use_scn%';
Variable_name	Value
innodb_use_scn	ON
insert into t1 values(6,1);
update t1 set c1=2 where id=5;
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
InnoDB		0 transactions not purged
# restart
insert into t1 values(7,1);
update t1 set c1=2 where id=6;
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
drop table t1;
InnoDB		0 transactions not purged

# MDEV-7394 test dynamic slave_skip_errors (writable when slaves stopped)
include/master-slave.inc
[connection master]
connection master;
CREATE TABLE t1 (id INT PRIMARY KEY);
include/sync_slave_sql_with_master.inc
connection slave;
INSERT INTO t1 VALUES (2);
connection master;
INSERT INTO t1 VALUES (2);
connection slave;
include/wait_for_slave_sql_error.inc [errno=1062]
SET GLOBAL slave_skip_errors = "1062";
SELECT @@global.slave_skip_errors;
@@global.slave_skip_errors
1062
START SLAVE;
include/wait_for_slave_to_start.inc
SET GLOBAL slave_skip_errors = "1062";
ERROR HY000: This operation cannot be performed as you have a running slave ''; run STOP SLAVE '' first
connection master;
INSERT INTO t1 VALUES (3);
include/sync_slave_sql_with_master.inc
connection slave;
SELECT COUNT(*) FROM t1 WHERE id=3;
COUNT(*)
1
STOP SLAVE;
SET GLOBAL slave_skip_errors = "OFF";
START SLAVE;
connection master;
DROP TABLE t1;
include/sync_slave_sql_with_master.inc
include/rpl_end.inc

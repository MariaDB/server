include/master-slave.inc
[connection master]
#
# MDEV-35160 RBR does not work with vector type, ER_SLAVE_CONVERSION_FAILED
#
create table t (pk int primary key, a vector(1) not null);
insert into t values (1, 0x00000000);
connection slave;
select pk, vec_totext(a) from t;
pk	vec_totext(a)
1	[0]
connection master;
drop table t;
#
# MDEV-35204 mysqlbinlog --verbose fails on row events with vector type
#
flush binary logs;
/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=1*/;
/*!40019 SET @@session.max_delayed_threads=0*/;
/*!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE,COMPLETION_TYPE=0*/;
DELIMITER /*!*/;
ROLLBACK/*!*/;
/*M!100101 SET @@session.skip_parallel_replication=0*//*!*/;
/*M!100001 SET @@session.gtid_domain_id=0*//*!*/;
/*M!100001 SET @@session.server_id=1*//*!*/;
/*M!100001 SET @@session.gtid_seq_no=1*//*!*/;
use `test`/*!*/;
SET @@session.pseudo_thread_id=123/*!*/;
SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0, @@session.unique_checks=1, @@session.autocommit=1, @@session.check_constraint_checks=1, @@session.sql_if_exists=0, @@session.explicit_defaults_for_timestamp=1, @@session.system_versioning_insert_history=0/*!*/;
SET @@session.sql_mode=1411383296/*!*/;
SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;
/*!\C latin1 *//*!*/;
SET @@session.character_set_client=latin1,@@session.collation_connection=8,@@session.collation_server=2304/*!*/;
SET @@session.lc_time_names=0/*!*/;
SET @@session.collation_database=DEFAULT/*!*/;
create table t (pk int primary key, a vector(1) not null)
/*!*/;
/*M!100001 SET @@session.gtid_seq_no=2*//*!*/;
START TRANSACTION
/*!*/;
#Q> insert into t values (1, 0x00000000)
### INSERT INTO `test`.`t`
### SET
###   @1=1
###   @2='\x00\x00\x00\x00'
# Number of rows: 1
COMMIT
/*!*/;
/*M!100001 SET @@session.gtid_seq_no=3*//*!*/;
DROP TABLE `t` /* generated by server */
/*!*/;
DELIMITER ;
# End of log file
ROLLBACK /* added by mysqlbinlog */;
/*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*/;
/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=0*/;
include/rpl_end.inc

include/rpl_init.inc [topology=1->2, 1->3]
# Case 1: immediately commits when the requirement is exact
CREATE TABLE t (a INT);
SHOW STATUS LIKE 'Rpl\_semi\_sync\_master\_%\_tx';
Variable_name	Value
Rpl_semi_sync_master_no_tx	0
Rpl_semi_sync_master_yes_tx	1
# Cases 2.1: a high requirement triggers `rpl_semi_sync_master_wait_no_slave=0`
SET @@GLOBAL.rpl_semi_sync_master_wait_for_slave_count= 3;
INSERT INTO t VALUES (0);
SHOW STATUS LIKE 'Rpl\_semi\_sync\_master\_%\_tx';
Variable_name	Value
Rpl_semi_sync_master_no_tx	1
Rpl_semi_sync_master_yes_tx	1
# Case 2.2: Semi-Sync turns back ON when the requirement is exact
SET @@GLOBAL.rpl_semi_sync_master_wait_for_slave_count= 2;
DROP TABLE t;
SHOW STATUS LIKE 'Rpl\_semi\_sync\_master\_%\_tx';
Variable_name	Value
Rpl_semi_sync_master_no_tx	1
Rpl_semi_sync_master_yes_tx	2
include/rpl_end.inc

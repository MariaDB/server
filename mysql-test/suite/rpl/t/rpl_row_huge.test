#
#
# References:
#   MDEV-:
#

--source include/have_sequence.inc
--source include/have_innodb.inc
#--source include/have_debug.inc
--source include/have_binlog_format_row.inc
--let $rpl_topology=1->2, 1->3
--source include/rpl_init.inc

--connection server_2
--source include/stop_slave.inc
--connection server_3
--source include/stop_slave.inc

--echo #
--echo # Initialize test data
--connection server_1
create table t1 (a int, b longblob) engine=innodb;
BEGIN;
--disable_query_log
--echo # Inserting query..
insert into t1 select seq,repeat("a",1000000000) from seq_1_to_3;
#insert into t1 select seq,repeat("a",10) from seq_1_to_5;
COMMIT;
--echo # Now inserting insert .. select
BEGIN;
insert into t1 select 7 as a, group_concat(b) as b from t1;
COMMIT;
update t1 set a=a+1 where a=7;
#insert into t1 values (1, repeat("a",3000000000));
#insert into t1 values (1, repeat('a',1000000000));
#--echo # Inserting query 2..
#insert into t1 values (2, repeat('b',1000000000));
#--echo # Inserting query 3..
#insert into t1 values (3, repeat('c',1000000000));
#--echo # Inserting query 4..
#insert into t1 values (4, repeat('d',1000000000));
#--echo # Inserting query 5..
#insert into t1 values (5, repeat('e',1000000000));
--enable_query_log
COMMIT;
--source include/save_master_gtid.inc

select * from t1;

--connection server_3
--source include/sync_with_master_gtid.inc

--echo #
--echo # Cleanup
--connection server_1
drop table t1;
--source include/save_master_gtid.inc

--connection server_3
--source include/sync_with_master_gtid.inc

--source include/rpl_end.inc
--echo # End of .test

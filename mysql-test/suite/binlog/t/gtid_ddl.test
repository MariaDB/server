--source include/have_binlog_format_mixed.inc

set @a=UNIX_TIMESTAMP("1970-01-21 15:32:22");
set timestamp=@a;
--let $MYSQLD_DATADIR= `select @@datadir`

--source include/reset_master.inc

CREATE TABLE t1 (a INT PRIMARY KEY, b INT) ENGINE=Aria;
INSERT INTO t1 VALUES (1, 0), (2, 1), (3, 2), (4, 4), (5, 8);
# Test the GTID event for the following alter; there was a but that it was
# not marked as DDL as it should.
--let $binlog_file= query_get_value(SHOW MASTER STATUS, File, 1)
--let $binlog_pos= query_get_value(SHOW MASTER STATUS, Position, 1)
ALTER TABLE t1 ENGINE=MRG_MyISAM;
--let $assert_file= $MYSQLTEST_VARDIR/tmp/mysqlbinlog.txt
--exec $MYSQL_BINLOG --start-position=$binlog_pos $MYSQLD_DATADIR/master-bin.000001 > $assert_file
--let $assert_text= Must have GTID event marked as ddl
--let $assert_select= GTID 0-1-[0-9]+ ddl
--let $assert_count= 1
--source include/assert_grep.inc
--remove_file $assert_file

DROP TABLE t1;

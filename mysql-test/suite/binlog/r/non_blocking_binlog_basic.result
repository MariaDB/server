set global non_blocking_binlog_threshold=1;
Warnings:
Warning	1292	Truncated incorrect non_blocking_binlog_threshold value: '1'
show variables like 'non_blocking_binlog_threshold';
Variable_name	Value
non_blocking_binlog_threshold	268435456
set global non_blocking_binlog_threshold=256*1024*1024;
show variables like 'non_blocking_binlog_threshold';
Variable_name	Value
non_blocking_binlog_threshold	268435456
set global non_blocking_binlog_threshold=default;
show variables like 'non_blocking_binlog_threshold';
Variable_name	Value
non_blocking_binlog_threshold	18446744073709551615
reset master;
create table t1(id int, c1 int) engine=innodb;
insert into t1 values(1,1);
set debug_dbug='+d,non_blocking_binlog_ignore_cache_size';
update t1 set c1=2;
set debug_dbug='-d,non_blocking_binlog_ignore_cache_size';
insert into t1 values(3,3);
show master status;
File	Position	Binlog_Do_DB	Binlog_Ignore_DB
master-bin.000002	#		
show binlog events in 'master-bin.000002';
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
master-bin.000002	#	Format_desc	#	#	#
master-bin.000002	#	Gtid_list	#	#	#
master-bin.000002	#	Binlog_checkpoint	#	#	#
master-bin.000002	#	Gtid	#	#	#
master-bin.000002	#	Ignorable log event	#	#	#
master-bin.000002	#	Annotate_rows	#	#	#
master-bin.000002	#	Table_map	#	#	#
master-bin.000002	#	Update_rows_v1	#	#	#
master-bin.000002	#	Xid	#	#	#
master-bin.000002	#	Gtid	#	#	#
master-bin.000002	#	Annotate_rows	#	#	#
master-bin.000002	#	Table_map	#	#	#
master-bin.000002	#	Write_rows_v1	#	#	#
master-bin.000002	#	Xid	#	#	#
drop table t1;
include/assert_grep.inc [write non-blocking binlog succeed should be logged]

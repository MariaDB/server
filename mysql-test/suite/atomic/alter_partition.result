# Crash recovery
create or replace procedure prepare_table()
begin
create or replace table t1 (x int)
with system versioning
partition by range(x) (
partition p0 values less than (10),
partition p1 values less than (20),
partition pn values less than maxvalue);
insert into t1 values (2), (12), (22);
flush tables;
end $
# QUERY: ALTER TABLE t1 EXTRACT PARTITION p1 AS TABLE tp1
# CRASH POINT: ddl_log_create_before_create_frm
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: ddl_log_alter_partition_after_create_frm
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: ddl_log_alter_partition_after_write_frm
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: crash_extract_partition_1
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: crash_extract_partition_2
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: crash_extract_partition_3
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: crash_extract_partition_4
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: crash_extract_partition_5
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: crash_extract_partition_6
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: crash_extract_partition_7
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#p1.MYD
t1#P#p1.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `p1` VALUES LESS THAN (20) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
12
22
# CRASH POINT: crash_extract_partition_8
t1#P#p0.MYD
t1#P#p0.MYI
t1#P#pn.MYD
t1#P#pn.MYI
t1.frm
t1.par
tp1.MYD
tp1.MYI
tp1.frm
#sql-backup-t1.frm
#sql-backup-t1.par
master-bin.000001	#	Query	#	#	use `test`; ALTER TABLE t1 EXTRACT PARTITION p1 AS TABLE tp1
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
 PARTITION BY RANGE (`x`)
(PARTITION `p0` VALUES LESS THAN (10) ENGINE = DEFAULT_ENGINE,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = DEFAULT_ENGINE)
x
2
22
Table	Create Table
tp1	CREATE TABLE `tp1` (
  `x` int(11) DEFAULT NULL
) ENGINE=DEFAULT_ENGINE DEFAULT CHARSET=latin1 WITH SYSTEM VERSIONING
x
12
Warnings:
Note	1051	Unknown table 'test.t1'

source include/have_debug_sync.inc;

--echo #
--echo # MDEV-37795 - MariaDB start up spits DDL_LOG: Got error 1033
--echo #
connect(ddl1, localhost, root);
CREATE TABLE t1(v VECTOR(5) NOT NULL, VECTOR INDEX(v));
SET debug_sync='writefile_after_create_before_write SIGNAL ready1 WAIT_FOR ever';
send ALTER TABLE t1 ADD COLUMN b INT, ALGORITHM=COPY;

connect(ddl2, localhost, root);
SET debug_sync='writefile_after_create_before_write SIGNAL ready2 WAIT_FOR ever';
send CREATE TABLE t2(v VECTOR(5) NOT NULL, VECTOR INDEX(v));

connection default;
SET debug_sync='now WAIT_FOR ready1';
SET debug_sync='now WAIT_FOR ready2';
let $shutdown_timeout=0;
source include/restart_mysqld.inc;

DROP TABLE t1;
error ER_BAD_TABLE_ERROR;
DROP TABLE t2;
SET debug_sync='RESET';
disconnect ddl1;
disconnect ddl2;
let $datadir=`select @@datadir`;
list_files $datadir/test;

# Test remote clone command to replace data directory
--source include/have_innodb.inc
--let $HOST = 127.0.0.1
--let $PORT =`select @@port`
--let $USER = root

--let clone_remote_replace = 1
--let clone_inst_number = 2
--let clone_err=ER_NOT_SUPPORTED_YET
--source ../include/clone_connection_begin.inc
--let $CLONE_DATADIR = $MYSQL_TMP_DIR/data_new

CREATE TABLE t1(col1 INT PRIMARY KEY, col2 char(64), FULLTEXT KEY fts_index(col2))ENGINE=InnoDB;

INSERT INTO t1 VALUES(10, 'clone row 1');
INSERT INTO t1 VALUES(20, 'clone row 2');
INSERT INTO t1 VALUES(30, 'clone row 3');

# Install Clone Plugin
--replace_result $MARIADB_CLONE_SO CLONE_PLUGIN
--eval INSTALL PLUGIN clone SONAME '$MARIADB_CLONE_SO'

SELECT PLUGIN_NAME, PLUGIN_STATUS FROM INFORMATION_SCHEMA.PLUGINS
WHERE PLUGIN_NAME LIKE '%clone%';

# Clone data
--source ../include/clone_command.inc
connection default;
--source ../include/clone_connection_end.inc
DROP TABLE t1;
UNINSTALL PLUGIN clone;

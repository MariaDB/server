INSTALL PLUGIN clone SONAME 'CLONE_PLUGIN';
SELECT PLUGIN_NAME, PLUGIN_STATUS
FROM INFORMATION_SCHEMA.PLUGINS
WHERE PLUGIN_NAME LIKE '%clone%';
PLUGIN_NAME	PLUGIN_STATUS
clone	ACTIVE
# ===== Engine iteration: CSV =====
DROP TABLE IF EXISTS t1, t2, t3, t4, t5,
t1_m1, t1_m2, t2_m1, t2_m2, t3_m1, t3_m2;
Warnings:
Note	1051	Unknown table 'test.t1,test.t2,test.t3,test.t4,test.t5,test.t1_m1,test.t1_m2,test.t2_m1,test.t2_m2,test.t3_m1,te...'
CREATE TABLE t1 (a INT NOT NULL) ENGINE=CSV;
CREATE TABLE t2 (a INT NOT NULL) ENGINE=CSV;
CREATE TABLE t3 (a INT NOT NULL) ENGINE=CSV;
CREATE TABLE t4 LIKE t1;
DROP TABLE t2;
RENAME TABLE t3 TO t5;
/home/satish/WORKSPACE/server/clone/bld_clone-debug/mysql-test/var/tmp/clone_noninnodb_3
CLONE LOCAL DATA DIRECTORY = 'CLONE_DATADIR';
# Restart server on cloned data directory
# restart: with restart_parameters
SELECT COUNT(*) FROM t4;
COUNT(*)
0
SELECT * FROM t2;
ERROR 42S02: Table 'test.t2' doesn't exist
SELECT * FROM t3;
ERROR 42S02: Table 'test.t3' doesn't exist
SELECT COUNT(*) FROM t5;
COUNT(*)
0
# restart
DROP TABLE IF EXISTS t4, t5, t1, t2, t3,
t1_m1, t1_m2, t2_m1, t2_m2, t3_m1, t3_m2;
Warnings:
Note	1051	Unknown table 'test.t2,test.t3,test.t1_m1,test.t1_m2,test.t2_m1,test.t2_m2,test.t3_m1,test.t3_m2'
# ===== Engine iteration: MERGE =====
DROP TABLE IF EXISTS t1, t2, t3, t4, t5,
t1_m1, t1_m2, t2_m1, t2_m2, t3_m1, t3_m2;
Warnings:
Note	1051	Unknown table 'test.t1,test.t2,test.t3,test.t4,test.t5,test.t1_m1,test.t1_m2,test.t2_m1,test.t2_m2,test.t3_m1,te...'
CREATE TABLE t1_m1 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t1_m2 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t1 (a INT NOT NULL)
ENGINE=MERGE UNION=(t1_m1, t1_m2) INSERT_METHOD=LAST;
CREATE TABLE t2_m1 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t2_m2 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t2 (a INT NOT NULL)
ENGINE=MERGE UNION=(t2_m1, t2_m2) INSERT_METHOD=LAST;
CREATE TABLE t3_m1 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t3_m2 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t3 (a INT NOT NULL)
ENGINE=MERGE UNION=(t3_m1, t3_m2) INSERT_METHOD=LAST;
CREATE TABLE t4 LIKE t1;
DROP TABLE t2;
RENAME TABLE t3 TO t5;
/home/satish/WORKSPACE/server/clone/bld_clone-debug/mysql-test/var/tmp/clone_noninnodb_2
CLONE LOCAL DATA DIRECTORY = 'CLONE_DATADIR';
# Restart server on cloned data directory
# restart: with restart_parameters
SELECT COUNT(*) FROM t4;
COUNT(*)
0
SELECT * FROM t2;
ERROR 42S02: Table 'test.t2' doesn't exist
SELECT * FROM t3;
ERROR 42S02: Table 'test.t3' doesn't exist
SELECT COUNT(*) FROM t5;
COUNT(*)
0
# restart
DROP TABLE IF EXISTS t4, t5, t1, t2, t3,
t1_m1, t1_m2, t2_m1, t2_m2, t3_m1, t3_m2;
Warnings:
Note	1051	Unknown table 'test.t2,test.t3'
# ===== Engine iteration: MyISAM =====
DROP TABLE IF EXISTS t1, t2, t3, t4, t5,
t1_m1, t1_m2, t2_m1, t2_m2, t3_m1, t3_m2;
Warnings:
Note	1051	Unknown table 'test.t1,test.t2,test.t3,test.t4,test.t5,test.t1_m1,test.t1_m2,test.t2_m1,test.t2_m2,test.t3_m1,te...'
CREATE TABLE t1 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t2 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t3 (a INT NOT NULL) ENGINE=MyISAM;
CREATE TABLE t4 LIKE t1;
DROP TABLE t2;
RENAME TABLE t3 TO t5;
/home/satish/WORKSPACE/server/clone/bld_clone-debug/mysql-test/var/tmp/clone_noninnodb_1
CLONE LOCAL DATA DIRECTORY = 'CLONE_DATADIR';
# Restart server on cloned data directory
# restart: with restart_parameters
SELECT COUNT(*) FROM t4;
COUNT(*)
0
SELECT * FROM t2;
ERROR 42S02: Table 'test.t2' doesn't exist
SELECT * FROM t3;
ERROR 42S02: Table 'test.t3' doesn't exist
SELECT COUNT(*) FROM t5;
COUNT(*)
0
# restart
DROP TABLE IF EXISTS t4, t5, t1, t2, t3,
t1_m1, t1_m2, t2_m1, t2_m2, t3_m1, t3_m2;
Warnings:
Note	1051	Unknown table 'test.t2,test.t3,test.t1_m1,test.t1_m2,test.t2_m1,test.t2_m2,test.t3_m1,test.t3_m2'
UNINSTALL PLUGIN clone;
disconnect clone_conn_1;
connection default;

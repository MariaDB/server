flush status;
flush hosts;
flush user_resources;
flush privileges;
select @@global.debug;
@@global.debug

select @@global.max_connect_errors;
@@global.max_connect_errors
100
select @@global.max_user_connections;
@@global.max_user_connections
1024
select @@global.max_connections;
@@global.max_connections
151
select `User`, `Host` from mysql.`user` where `host` like '%\\%%';
User	Host
select `User`, `Host` from mysql.`user` where `user` like '192.%';
User	Host
select `User`, `Host` from mysql.`user` where `user` like '2001:%';
User	Host
select `User`, `Host` from mysql.`user` where `user` like 'santa.claus.%';
User	Host
select @@global.max_connections into @saved_max_connections;
select @@global.max_user_connections into @saved_max_user_connections;
create user 'quota'@'santa.claus.ipv6.example.com';
grant select on test.* to 'quota'@'santa.claus.ipv6.example.com';
grant usage on *.* to 'quota'@'santa.claus.ipv6.example.com'
  with max_connections_per_hour 3;
connect  con1,"::1",root,,test,$MASTER_MYPORT,;
select "Con1 is alive";
Con1 is alive
Con1 is alive
select current_user();
current_user()
root@localhost
disconnect con1;
connection default;
set global debug_dbug= "+d,vio_peer_addr_fake_ipv6,getnameinfo_fake_ipv6,getaddrinfo_fake_good_ipv6";
connect  con2a,"::1",quota,,test,$MASTER_MYPORT,;
select "Con2a is alive";
Con2a is alive
Con2a is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
disconnect con2a;
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	0
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	null
LAST_ERROR_SEEN	null
connect  con2b,"::1",quota,,test,$MASTER_MYPORT,;
select "Con2b is alive";
Con2b is alive
Con2b is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
disconnect con2b;
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	0
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	null
LAST_ERROR_SEEN	null
connect  con2c,"::1",quota,,test,$MASTER_MYPORT,;
select "Con2c is alive";
Con2c is alive
Con2c is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
disconnect con2c;
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	0
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	null
LAST_ERROR_SEEN	null
ERROR 42000: User 'quota' has exceeded the 'max_connections_per_hour' resource (current value: 3)
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	1
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
ERROR 42000: User 'quota' has exceeded the 'max_connections_per_hour' resource (current value: 3)
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
grant usage on *.* to 'quota'@'santa.claus.ipv6.example.com'
  with max_connections_per_hour 0;
grant usage on *.* to 'quota'@'santa.claus.ipv6.example.com'
  with max_user_connections 3;
flush user_resources;
connect  con3a,"::1",quota,,test,$MASTER_MYPORT,;
select "Con7 is alive";
Con7 is alive
Con7 is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
connect  con3b,"::1",quota,,test,$MASTER_MYPORT,;
select "Con3b is alive";
Con3b is alive
Con3b is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
connect  con3c,"::1",quota,,test,$MASTER_MYPORT,;
select "Con3c is alive";
Con3c is alive
Con3c is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
ERROR 42000: User 'quota' has exceeded the 'max_user_connections' resource (current value: 3)
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	1
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
ERROR 42000: User 'quota' has exceeded the 'max_user_connections' resource (current value: 3)
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	2
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
disconnect con3a;
disconnect con3b;
disconnect con3c;
grant usage on *.* to 'quota'@'santa.claus.ipv6.example.com'
  with max_user_connections 0;
flush user_resources;
set global max_user_connections = 3;
connect  con4a,"::1",quota,,test,$MASTER_MYPORT,;
select "Con4a is alive";
Con4a is alive
Con4a is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	2
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
connect  con4b,"::1",quota,,test,$MASTER_MYPORT,;
select "Con4b is alive";
Con4b is alive
Con4b is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	2
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
connect  con4c,"::1",quota,,test,$MASTER_MYPORT,;
select "Con4c is alive";
Con4c is alive
Con4c is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	2
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
ERROR 42000: User quota already has more than 'max_user_connections' active connections
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	3
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
ERROR 42000: User quota already has more than 'max_user_connections' active connections
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	4
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
disconnect con4a;
disconnect con4b;
disconnect con4c;
set global max_user_connections = 0;
set global max_connections = 10;
flush user_resources;
connect  tmp_con1,"::1",quota,,test,$MASTER_MYPORT,;
connect  tmp_con2,"::1",quota,,test,$MASTER_MYPORT,;
connect  tmp_con3,"::1",quota,,test,$MASTER_MYPORT,;
connect  tmp_con4,"::1",quota,,test,$MASTER_MYPORT,;
connect  tmp_con5,"::1",quota,,test,$MASTER_MYPORT,;
connect  tmp_con6,"::1",quota,,test,$MASTER_MYPORT,;
connect  tmp_con7,"::1",quota,,test,$MASTER_MYPORT,;
connect  con5a,"::1",quota,,test,$MASTER_MYPORT,;
select "Con4a is alive";
Con4a is alive
Con4a is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	4
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
connect  con5b,"::1",quota,,test,$MASTER_MYPORT,;
select "Con5b is alive";
Con5b is alive
Con5b is alive
select current_user();
current_user()
quota@santa.claus.ipv6.example.com
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	4
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
Got one of the listed errors
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	4
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
Got one of the listed errors
connection default;
"Dumping performance_schema.host_cache"
IP	2001:db8::6:6
HOST	santa.claus.ipv6.example.com
HOST_VALIDATED	YES
SUM_CONNECT_ERRORS	0
COUNT_HOST_BLOCKED_ERRORS	0
COUNT_NAMEINFO_TRANSIENT_ERRORS	0
COUNT_NAMEINFO_PERMANENT_ERRORS	0
COUNT_FORMAT_ERRORS	0
COUNT_ADDRINFO_TRANSIENT_ERRORS	0
COUNT_ADDRINFO_PERMANENT_ERRORS	0
COUNT_FCRDNS_ERRORS	0
COUNT_HOST_ACL_ERRORS	0
COUNT_NO_AUTH_PLUGIN_ERRORS	0
COUNT_AUTH_PLUGIN_ERRORS	0
COUNT_HANDSHAKE_ERRORS	0
COUNT_PROXY_USER_ERRORS	0
COUNT_PROXY_USER_ACL_ERRORS	0
COUNT_AUTHENTICATION_ERRORS	0
COUNT_SSL_ERRORS	0
COUNT_MAX_USER_CONNECTIONS_ERRORS	4
COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS	2
COUNT_DEFAULT_DATABASE_ERRORS	0
COUNT_INIT_CONNECT_ERRORS	0
COUNT_LOCAL_ERRORS	0
COUNT_UNKNOWN_ERRORS	0
FIRST_ERROR_SEEN	set
LAST_ERROR_SEEN	set
disconnect con5a;
disconnect con5b;
disconnect tmp_con1;
disconnect tmp_con2;
disconnect tmp_con3;
disconnect tmp_con4;
disconnect tmp_con5;
disconnect tmp_con6;
disconnect tmp_con7;
set global max_connections = @saved_max_connections;
set global max_user_connections = @saved_max_user_connections;
drop user 'quota'@'santa.claus.ipv6.example.com';
set global debug_dbug= default;

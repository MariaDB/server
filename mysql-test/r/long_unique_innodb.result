#test for concurrent insert of long unique in innodb 
create table t1(a blob unique) engine= InnoDB;
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` blob DEFAULT NULL,
  UNIQUE KEY `a` (`a`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
connect  'con1', localhost, root,,;
connect  'con2', localhost, root,,;
connection con1;
set  transaction isolation level READ UNCOMMITTED;
start transaction;
insert into t1 values('RUC');
connection con2;
set  transaction isolation level READ UNCOMMITTED;
start transaction;
insert into t1 values ('RUC');
connection con1;
commit;
set  transaction isolation level READ COMMITTED;
start transaction;
insert into t1 values('RC');
connection con2;
commit;
set  transaction isolation level READ COMMITTED;
start transaction;
insert into t1 values ('RC');
commit;
connection con1;
commit;
set  transaction isolation level REPEATABLE READ;
start transaction;
insert into t1 values('RR');
connection con2;
commit;
set  transaction isolation level REPEATABLE READ;
start transaction;
insert into t1 values ('RR');
ERROR HY000: Lock wait timeout exceeded; try restarting transaction
connection con1;
commit;
set  transaction isolation level SERIALIZABLE;
start transaction;
insert into t1 values('S');
connection con2;
commit;
set  transaction isolation level SERIALIZABLE;
start transaction;
insert into t1 values ('S');
ERROR HY000: Lock wait timeout exceeded; try restarting transaction
commit;
connection con1;
commit;
connection default;
disconnect con1;
disconnect con2;
select * from t1;
a
RUC
RUC
RC
RC
RR
S
drop table t1;

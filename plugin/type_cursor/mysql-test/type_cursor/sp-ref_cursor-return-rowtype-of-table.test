SET sql_mode=ORACLE;

--echo #
--echo # MDEV-10152 Add support for TYPE .. IS REF CURSOR
--echo #

#
# RETURN var%ROWTYPE - qualified identifiers
#

DELIMITER $$;
--error ER_PARSE_ERROR
CREATE PROCEDURE p1 AS
  TYPE cur0_t IS REF CURSOR RETURN cat1.db1.t1.v0%ROWTYPE;
BEGIN
  NULL;
END;
$$
DELIMITER ;$$

DELIMITER $$;
--error ER_PARSE_ERROR
CREATE PROCEDURE p1 AS
  TYPE cur0_t IS REF CURSOR RETURN cat1.db1.t1%ROWTYPE;
BEGIN
  NULL;
END;
$$
DELIMITER ;$$

# No error if no variable (only TYPE)
DELIMITER $$;
CREATE PROCEDURE p1 AS
  TYPE cur0_t IS REF CURSOR RETURN test.t1%ROWTYPE;
BEGIN
  NULL;
END;
$$
DELIMITER ;$$
CALL p1;
DROP PROCEDURE p1;


# The variable declaration raises ER_NO_SUCH_TABLE
# Even if there is no OPEN for this variable

DELIMITER $$;
CREATE PROCEDURE p1 AS
  TYPE cur0_t IS REF CURSOR RETURN test.t1%ROWTYPE;
  c0 cur0_t;
BEGIN
  NULL;
END;
$$
DELIMITER ;$$
--error ER_NO_SUCH_TABLE
CALL p1;
DROP PROCEDURE p1;

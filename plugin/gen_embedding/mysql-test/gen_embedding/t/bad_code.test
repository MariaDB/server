source include/have_gen_embedding.inc;

call mtr.add_suppression("GENERATE_EMBEDDING_OPENAI: Bad http response code: 400");

# Currently only checks that an http error code is handled correctly,
# without examining the response body

--replace_result $OPENAI_PORT OPENAI_PORT
eval set generate_embedding_openai_host="http://127.0.0.1:$OPENAI_PORT/errorcode";
select vec_totext(generate_embedding_openai('abc', 'text-embedding-ada-002'));